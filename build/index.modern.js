import t from"jszip";import e from"tweetnacl";import r from"tweetnacl-util";import n from"web3";import i from"@metamask/detect-provider";import o from"protons";import s from"multihashing";import a from"cids";import u from"libp2p";import c from"libp2p-websockets";import l from"multiaddr";import h from"uint8arrays/to-string";import{NOISE as f}from"libp2p-noise";import d from"libp2p-mplex";import p from"libp2p-kad-dht";import y from"peer-id";import g from"libp2p-bootstrap";import m from"it-pipe";import"it-length-prefixed";import"it-pushable";import b from"secrets.js-lit";import v from"uint8arrays/from-string";import w from"it-all";var _="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function E(t){var e={exports:{}};return t(e,e.exports),e.exports}E(function(t){var e=function(t){var e,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var i=Object.create((e&&e.prototype instanceof g?e:g).prototype),o=new k(n||[]);return i._invoke=function(t,e,r){var n=h;return function(i,o){if(n===d)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw o;return O()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=R(s,r);if(a){if(a===y)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var u=l(t,e,r);if("normal"===u.type){if(n=r.done?p:f,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(t,r,o),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",y={};function g(){}function m(){}function b(){}var v={};v[o]=function(){return this};var w=Object.getPrototypeOf,_=w&&w(w(I([])));_&&_!==r&&n.call(_,o)&&(v=_);var E=b.prototype=g.prototype=Object.create(v);function S(t){["next","throw","return"].forEach(function(e){u(t,e,function(t){return this._invoke(e,t)})})}function T(t,e){function r(i,o,s,a){var u=l(t[i],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){r("next",t,s,a)},function(t){r("throw",t,s,a)}):e.resolve(h).then(function(t){c.value=t,s(c)},function(t){return r("throw",t,s,a)})}a(u.arg)}var i;this._invoke=function(t,n){function o(){return new e(function(e,i){r(t,n,e,i)})}return i=i?i.then(o,o):o()}}function R(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,R(t,r),"throw"===r.method))return y;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var i=l(n,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(t){if(t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return s.next=s}}return{next:O}}function O(){return{value:e,done:!0}}return m.prototype=E.constructor=b,b.constructor=m,m.displayName=u(b,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,a,"GeneratorFunction")),t.prototype=Object.create(E),t},t.awrap=function(t){return{__await:t}},S(T.prototype),T.prototype[s]=function(){return this},t.AsyncIterator=T,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new T(c(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then(function(t){return t.done?t.value:s.next()})},S(E),u(E,a,"Generator"),E[o]=function(){return this},E.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=I,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return a.type="throw",a.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}});const S={name:"AES-CBC",length:256};function T(t,n,i){switch(i){case"x25519-xsalsa20-poly1305":{const i=e.box.keyPair();let o;try{o=r.decodeBase64(t)}catch(t){throw new Error("Bad public key")}const s=r.decodeUTF8(n),a=e.randomBytes(e.box.nonceLength),u=e.box(s,a,o,i.secretKey);return{version:"x25519-xsalsa20-poly1305",nonce:r.encodeBase64(a),ephemPublicKey:r.encodeBase64(i.publicKey),ciphertext:r.encodeBase64(u)}}default:throw new Error("Encryption type/version not supported")}}function R(t,n){switch(t.version){case"x25519-xsalsa20-poly1305":{const i=r.decodeBase64(n),o=r.decodeBase64(t.nonce),s=r.decodeBase64(t.ciphertext),a=r.decodeBase64(t.ephemPublicKey),u=e.box.open(s,o,a,i);let c;try{c=r.encodeUTF8(u)}catch(t){throw new Error("Decryption failed.  Could not encode result as utf8")}if(c)return c;throw new Error("Decryption failed.  Output is falsy")}default:throw new Error("Encryption type/version not supported.")}}var A=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"userAddress",type:"address"},{indexed:!1,internalType:"address payable",name:"relayerAddress",type:"address"},{indexed:!1,internalType:"bytes",name:"functionSignature",type:"bytes"}],name:"MetaTransactionExecuted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256[]",name:"ids",type:"uint256[]"},{indexed:!1,internalType:"uint256[]",name:"values",type:"uint256[]"}],name:"TransferBatch",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"TransferSingle",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"value",type:"string"},{indexed:!0,internalType:"uint256",name:"id",type:"uint256"}],name:"URI",type:"event"},{inputs:[],name:"ERC712_VERSION",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"id",type:"uint256"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address[]",name:"accounts",type:"address[]"},{internalType:"uint256[]",name:"ids",type:"uint256[]"}],name:"balanceOfBatch",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"userAddress",type:"address"},{internalType:"bytes",name:"functionSignature",type:"bytes"},{internalType:"bytes32",name:"sigR",type:"bytes32"},{internalType:"bytes32",name:"sigS",type:"bytes32"},{internalType:"uint8",name:"sigV",type:"uint8"}],name:"executeMetaTransaction",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"payable",type:"function",payable:!0},{inputs:[],name:"getChainId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function",constant:!0},{inputs:[],name:"getDomainSeperator",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getNonce",outputs:[{internalType:"uint256",name:"nonce",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"ids",type:"uint256[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeBatchTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"id",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"tokenIds",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"uri",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_owner",type:"address"},{internalType:"address",name:"_operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"isOperator",type:"bool"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"bool",name:"enabled",type:"bool"}],name:"setOpenseaProxyEnabled",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newAdmin",type:"address"}],name:"changeAdmin",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"uri",type:"string"}],name:"setURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getAdmin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function",constant:!0}];const C=o("\nmessage Request {\n  enum Type {\n    HANDSHAKE = 0;\n    GET_KEY_FRAGMENT = 1;\n    STORE_KEY_FRAGMENT = 2;\n  }\n  required Type type = 1;\n  optional GetKeyFragment getKeyFragment = 2;\n  optional StoreKeyFragment storeKeyFragment = 3;\n  optional bytes authSig = 4;\n  optional TokenParams tokenParams = 5;\n  optional bytes clientPubKey = 6;\n}\nmessage Response {\n  enum Type {\n    HANDSHAKE_RESPONSE = 0;\n    GET_KEY_FRAGMENT_RESPONSE = 1;\n    STORE_KEY_FRAGMENT_RESPONSE = 2;\n  }\n  required Type type = 1;\n  optional GetKeyFragmentResponse getKeyFragmentResponse = 2;\n  optional StoreKeyFragmentResponse storeKeyFragmentResponse = 3;\n  optional bytes serverPubKey = 4;\n}\nmessage GetKeyFragment {\n  required bytes keyId = 1;\n}\nmessage GetKeyFragmentResponse {\n  enum Result {\n    SUCCESS = 0;\n    NOT_FOUND = 1;\n    AUTH_FAILURE = 2;\n    ERROR = 3;\n  }\n  required Result result = 1;\n  optional bytes keyId = 2;\n  optional bytes fragmentValue = 3;\n}\nmessage StoreKeyFragment {\n  required bytes fragmentValue = 1;\n}\nmessage StoreKeyFragmentResponse {\n  enum Result {\n    SUCCESS = 0;\n    AUTH_FAILURE = 1;\n    ERROR = 2;\n  }\n  required Result result = 1;\n  optional bytes errorMessage = 2;\n}\nmessage TokenParams {\n  required bytes tokenAddress = 1;\n  required bytes tokenId = 2;\n  required bytes chain = 3;\n}\n"),k={polygon:{contractAddress:"0xb9A323711528D0c5a70df790929f4739f1cDd7fD",chainId:137},ethereum:{contractAddress:"0x55485885e82E25446DEC314Ccb810Bda06B9e01B",chainId:1}};async function I(){if(void 0===window.ethereum)throw new Error({errorCode:"no_wallet",message:"No web3 wallet was found"});const t=await i(),e=(await t.request({method:"eth_requestAccounts"}))[0].toLowerCase();return{web3:new n(t),account:e}}async function O(){let t=localStorage.getItem("lit-auth-signature");t||(await M(),t=localStorage.getItem("lit-auth-signature")),t=JSON.parse(t);const{account:e}=await I();return e!==t.address&&(await M(),t=localStorage.getItem("lit-auth-signature"),t=JSON.parse(t)),t}async function M(){const t=(new Date).toISOString(),n="I am creating an account to use LITs at {{timestamp}}".replace("{{timestamp}}",t),i=await async function({body:t}){const{web3:e,account:r}=await I();console.log("signing with ",r);const n=await e.eth.personal.sign(t,r),i=e.eth.accounts.recover(t,n).toLowerCase();if(console.log("Signature: ",n),console.log("recovered address: ",i),i!==r){const t=`ruh roh, the user signed with a different address (${i}) then they're using with web3 (${r}).  this will lead to confusion.`;throw console.error(t),alert("something seems to be wrong with your wallets message signing.  maybe restart your browser or your wallet.  your recovered sig address does not match your web3 account address"),new Error(t)}return{signature:n,address:i}}({body:n});localStorage.setItem("lit-auth-signature",JSON.stringify({sig:i.signature,derivedVia:"web3.eth.personal.sign",signedMessage:n,address:i.address}));const o=e.box.keyPair();localStorage.setItem("lit-comms-keypair",JSON.stringify({publicKey:r.encodeBase64(o.publicKey),secretKey:r.encodeBase64(o.secretKey)})),console.log("generated and saved lit-comms-keypair")}const B={};async function x(e,r){const n=await async function(t){return await crypto.subtle.importKey("jwk",JSON.parse(t),S,!0,["encrypt","decrypt"])}(r),i=await async function(t,e){const r=await t.slice(0,16).arrayBuffer(),n=await t.slice(16).arrayBuffer();return await crypto.subtle.decrypt({name:"AES-CBC",iv:r},e,n)}(e,n),o=new t;return(await o.loadAsync(i)).files}async function N(t){const e=await t.generateAsync({type:"blob"}),r=await e.arrayBuffer();console.log("blob",e);const n=await async function(){return await crypto.subtle.generateKey(S,!0,["encrypt","decrypt"])}(),i=await async function(t,e){const r=window.crypto.getRandomValues(new Uint8Array(16)),n=await crypto.subtle.encrypt({name:"AES-CBC",iv:r},t,e);return new Blob([r,new Uint8Array(n)],{type:"application/octet-stream"})}(n,r),o=await crypto.subtle.exportKey("jwk",n);return console.log("exportedSymmKey",o),{symmetricKey:JSON.stringify(o),encryptedZip:i}}async function L(t){if(B[t])return B[t];const e=await fetch("https://unpkg.com/"+t);if(!e.ok)throw console.log("error with response: ",e),Error(e.statusText);const r=await e.blob(),n=await(i=r,new Promise((t,e)=>{const r=new FileReader;r.onloadend=()=>{t(r.result)},r.readAsDataURL(i)}));var i;return B[t]=n,n}const D=({tokenAddress:t,tokenId:e,chain:r})=>{const n=t.toLowerCase(),i=e.toString(16).padStart(64,"0"),o=s(Buffer.from(`${n}|${i}|${r}`),"sha2-256");return new a(o).toString()};var P=1e3,j=60*P,F=60*j,U=24*F,q=function(t,e){e=e||{};var r=typeof t;if("string"===r&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return r*U;case"hours":case"hour":case"hrs":case"hr":case"h":return r*F;case"minutes":case"minute":case"mins":case"min":case"m":return r*j;case"seconds":case"second":case"secs":case"sec":case"s":return r*P;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(t);if("number"===r&&isFinite(t))return e.long?function(t){var e=Math.abs(t);return e>=U?G(t,e,U,"day"):e>=F?G(t,e,F,"hour"):e>=j?G(t,e,j,"minute"):e>=P?G(t,e,P,"second"):t+" ms"}(t):function(t){var e=Math.abs(t);return e>=U?Math.round(t/U)+"d":e>=F?Math.round(t/F)+"h":e>=j?Math.round(t/j)+"m":e>=P?Math.round(t/P)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function G(t,e,r,n){var i=e>=1.5*r;return Math.round(t/r)+" "+n+(i?"s":"")}var $=E(function(t,e){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;e.splice(1,0,r,"color: inherit");let n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(n++,"%c"===t&&(i=n))}),e.splice(i,0,r)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=function(t){function e(t){let n,i=null;function o(...t){if(!o.enabled)return;const r=o,i=Number(new Date);r.diff=i-(n||i),r.prev=n,r.curr=i,n=i,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(n,i)=>{if("%%"===n)return"%";s++;const o=e.formatters[i];return"function"==typeof o&&(n=o.call(r,t[s]),t.splice(s,1),s--),n}),e.formatArgs.call(r,t),(r.log||e.log).apply(r,t)}return o.namespace=t,o.useColors=e.useColors(),o.color=e.selectColor(t),o.extend=r,o.destroy=e.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null===i?e.enabled(t):i,set:t=>{i=t}}),"function"==typeof e.init&&e.init(o),o}function r(t,r){const n=e(this.namespace+(void 0===r?":":r)+t);return n.log=this.log,n}function n(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){const t=[...e.names.map(n),...e.skips.map(n).map(t=>"-"+t)].join(",");return e.enable(""),t},e.enable=function(t){let r;e.save(t),e.names=[],e.skips=[];const n=("string"==typeof t?t:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(t=n[r].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let r,n;for(r=0,n=e.skips.length;r<n;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;r<n;r++)if(e.names[r].test(t))return!0;return!1},e.humanize=q,e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(r=>{e[r]=t[r]}),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let r=0;for(let e=0;e<t.length;e++)r=(r<<5)-r+t.charCodeAt(e),r|=0;return e.colors[Math.abs(r)%e.colors.length]},e.enable(e.load()),e}(e);const{formatters:r}=t.exports;r.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});function K(t,e){for(const r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}for(var H=function(t,e,r){if(!t||"string"==typeof t)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"==typeof e&&(r=e,e=""),e&&(r.code=e);try{return K(t,r)}catch(e){r.message=t.message,r.stack=t.stack;const n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),K(new n,r)}},V={__proto__:null,default:{}},W=function(){if("undefined"==typeof globalThis)return null;var t={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return t.RTCPeerConnection?t:null},z=[],Y=[],Z="undefined"!=typeof Uint8Array?Uint8Array:Array,J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X=0,Q=J.length;X<Q;++X)z[X]=J[X],Y[J.charCodeAt(X)]=X;function tt(t,e,r){for(var n,i=[],o=e;o<r;o+=3)i.push(z[(n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]))>>18&63]+z[n>>12&63]+z[n>>6&63]+z[63&n]);return i.join("")}Y["-".charCodeAt(0)]=62,Y["_".charCodeAt(0)]=63;var et,rt=function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,l=-7,h=r?i-1:0,f=r?-1:1,d=t[e+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:Infinity*(d?-1:1);s+=Math.pow(2,n),o-=c}return(d?-1:1)*s*Math.pow(2,o-n)},nt=function(t,e,r,n,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||Infinity===e?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[r+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[r+d]=255&s,d+=p,s/=256,c-=8);t[r+d-p]|=128*y},it=E(function(t,e){var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=function(t){return+t!=t&&(t=0),o.alloc(+t)},e.INSPECT_MAX_BYTES=50;var n=2147483647;function i(t){if(t>n)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,o.prototype),e}function o(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return s(t,e,r)}function s(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|f(t,e),n=i(r),s=n.write(t,e);return s!==r&&(n=n.slice(0,s)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(j(t,Uint8Array)){var e=new Uint8Array(t);return l(e.buffer,e.byteOffset,e.byteLength)}return c(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(j(t,ArrayBuffer)||t&&j(t.buffer,ArrayBuffer))return l(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(j(t,SharedArrayBuffer)||t&&j(t.buffer,SharedArrayBuffer)))return l(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return o.from(n,e,r);var s=function(t){if(o.isBuffer(t)){var e=0|h(t.length),r=i(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||F(t.length)?i(0):c(t):"Buffer"===t.type&&Array.isArray(t.data)?c(t.data):void 0}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return a(t),i(t<0?0:0|h(t))}function c(t){for(var e=t.length<0?0:0|h(t.length),r=i(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function l(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,o.prototype),n}function h(t){if(t>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|t}function f(t,e){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||j(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return D(t).length;default:if(i)return n?-1:L(t).length;e=(""+e).toLowerCase(),i=!0}}function d(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,r);case"utf8":case"utf-8":return S(this,e,r);case"ascii":return R(this,e,r);case"latin1":case"binary":return A(this,e,r);case"base64":return E(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function p(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function y(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),F(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=o.from(e,n)),o.isBuffer(e))return 0===e.length?-1:g(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):g(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function g(t,e,r,n,i){var o,s=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=r;o<a;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function m(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(F(a))return s;t[r+s]=a}return s}function b(t,e,r,n){return P(L(e,t.length-r),t,r,n)}function v(t,e,r,n){return P(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function w(t,e,r,n){return P(D(e),t,r,n)}function _(t,e,r,n){return P(function(t,e){for(var r,n,i=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(r=t.charCodeAt(o))>>8,i.push(r%256),i.push(n);return i}(e,t.length-r),t,r,n)}function E(t,e,r){return function(t){for(var e,r=t.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(tt(t,s,s+o>a?a:s+o));return 1===n?i.push(z[(e=t[r-1])>>2]+z[e<<4&63]+"=="):2===n&&i.push(z[(e=(t[r-2]<<8)+t[r-1])>>10]+z[e>>4&63]+z[e<<2&63]+"="),i.join("")}(0===e&&r===t.length?t:t.slice(e,r))}function S(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,s,a,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=r)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:s=t[i+2],128==(192&(o=t[i+1]))&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:s=t[i+2],a=t[i+3],128==(192&(o=t[i+1]))&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(n.push((l-=65536)>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=h}return function(t){var e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=T));return r}(n)}e.kMaxLength=n,(o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(t,e,r){return s(t,e,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(t,e,r){return function(t,e,r){return a(t),t<=0?i(t):void 0!==e?"string"==typeof r?i(t).fill(e,r):i(t).fill(e):i(t)}(t,e,r)},o.allocUnsafe=function(t){return u(t)},o.allocUnsafeSlow=function(t){return u(t)},o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,e){if(j(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),j(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=o.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(j(s,Uint8Array))i+s.length>n.length?o.from(s).copy(n,i):Uint8Array.prototype.set.call(n,s,i);else{if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i)}i+=s.length}return n},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)p(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)p(this,e,e+3),p(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)p(this,e,e+7),p(this,e+1,e+6),p(this,e+2,e+5),p(this,e+3,e+4);return this},o.prototype.toLocaleString=o.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?S(this,0,t):d.apply(this,arguments)},o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(t,e,r,n,i){if(j(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),u=Math.min(s,a),c=this.slice(n,i),l=t.slice(e,r),h=0;h<u;++h)if(c[h]!==l[h]){s=c[h],a=l[h];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},o.prototype.indexOf=function(t,e,r){return y(this,t,e,r,!0)},o.prototype.lastIndexOf=function(t,e,r){return y(this,t,e,r,!1)},o.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return m(this,t,e,r);case"utf8":case"utf-8":return b(this,t,e,r);case"ascii":case"latin1":case"binary":return v(this,t,e,r);case"base64":return w(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function R(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function A(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function C(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=U[t[o]];return i}function k(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function I(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,r,n,i,s){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function M(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(t,e,r,n,i){return e=+e,r>>>=0,i||M(t,0,r,4),nt(t,e,r,n,23,4),r+4}function x(t,e,r,n,i){return e=+e,r>>>=0,i||M(t,0,r,8),nt(t,e,r,n,52,8),r+8}o.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUintLE=o.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||I(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},o.prototype.readUintBE=o.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||I(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},o.prototype.readUint8=o.prototype.readUInt8=function(t,e){return t>>>=0,e||I(t,1,this.length),this[t]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(t,e){return t>>>=0,e||I(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(t,e){return t>>>=0,e||I(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(t,e){return t>>>=0,e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(t,e){return t>>>=0,e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||I(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},o.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||I(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},o.prototype.readInt8=function(t,e){return t>>>=0,e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){t>>>=0,e||I(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(t,e){t>>>=0,e||I(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(t,e){return t>>>=0,e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t>>>=0,e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||I(t,4,this.length),rt(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||I(t,4,this.length),rt(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||I(t,8,this.length),rt(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||I(t,8,this.length),rt(this,t,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||O(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||O(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},o.prototype.writeUint8=o.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,255,0),this[e]=255&t,e+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);O(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},o.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);O(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},o.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeFloatLE=function(t,e,r){return B(this,t,e,!0,r)},o.prototype.writeFloatBE=function(t,e,r){return B(this,t,e,!1,r)},o.prototype.writeDoubleLE=function(t,e,r){return x(this,t,e,!0,r)},o.prototype.writeDoubleBE=function(t,e,r){return x(this,t,e,!1,r)},o.prototype.copy=function(t,e,r,n){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},o.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var a=o.isBuffer(t)?t:o.from(t,n),u=a.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=a[s%u]}return this};var N=/[^+/0-9A-Za-z-_]/g;function L(t,e){var r;e=e||Infinity;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function D(t){return function(t){var e,r,n=function(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}(t),i=n[0],o=n[1],s=new Z(function(t,e,r){return 3*(e+r)/4-r}(0,i,o)),a=0,u=o>0?i-4:i;for(r=0;r<u;r+=4)e=Y[t.charCodeAt(r)]<<18|Y[t.charCodeAt(r+1)]<<12|Y[t.charCodeAt(r+2)]<<6|Y[t.charCodeAt(r+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;return 2===o&&(e=Y[t.charCodeAt(r)]<<2|Y[t.charCodeAt(r+1)]>>4,s[a++]=255&e),1===o&&(e=Y[t.charCodeAt(r)]<<10|Y[t.charCodeAt(r+1)]<<4|Y[t.charCodeAt(r+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e),s}(function(t){if((t=(t=t.split("=")[0]).trim().replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function P(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function j(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function F(t){return t!=t}var U=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()}),ot=E(function(t,e){var r=it.Buffer;function n(t,e){for(var r in t)e[r]=t[r]}function i(t,e,n){return r(t,e,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=it:(n(it,e),e.Buffer=i),i.prototype=Object.create(r.prototype),n(r,i),i.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return r(t,e,n)},i.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var i=r(t);return void 0!==e?"string"==typeof n?i.fill(e,n):i.fill(e):i.fill(0),i},i.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r(t)},i.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return it.SlowBuffer(t)}}),st=E(function(t){var e=65536,r=ot.Buffer,n=_.crypto||_.msCrypto;t.exports=n&&n.getRandomValues?function(t,i){if(t>4294967295)throw new RangeError("requested too many random bytes");var o=r.allocUnsafe(t);if(t>0)if(t>e)for(var s=0;s<t;s+=e)n.getRandomValues(o.slice(s,s+e));else n.getRandomValues(o);return"function"==typeof i?process.nextTick(function(){i(null,o)}):o}:function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}),at="object"==typeof Reflect?Reflect:null,ut=at&&"function"==typeof at.apply?at.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};et=at&&"function"==typeof at.ownKeys?at.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var ct=Number.isNaN||function(t){return t!=t};function lt(){lt.init.call(this)}var ht=lt;lt.EventEmitter=lt,lt.prototype._events=void 0,lt.prototype._eventsCount=0,lt.prototype._maxListeners=void 0;var ft=10;function dt(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function pt(t){return void 0===t._maxListeners?lt.defaultMaxListeners:t._maxListeners}function yt(t,e,r,n){var i,o,s;if(dt(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),void 0===s)s=o[e]=r,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=pt(t))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,console&&console.warn&&console.warn(a)}return t}function gt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function mt(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=gt.bind(n);return i.listener=r,n.wrapFn=i,i}function bt(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):wt(i,i.length)}function vt(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function wt(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function _t(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)})}}Object.defineProperty(lt,"defaultMaxListeners",{enumerable:!0,get:function(){return ft},set:function(t){if("number"!=typeof t||t<0||ct(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ft=t}}),lt.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},lt.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||ct(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},lt.prototype.getMaxListeners=function(){return pt(this)},lt.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)ut(a,this,e);else{var u=a.length,c=wt(a,u);for(r=0;r<u;++r)ut(c[r],this,e)}return!0},lt.prototype.on=lt.prototype.addListener=function(t,e){return yt(this,t,e,!1)},lt.prototype.prependListener=function(t,e){return yt(this,t,e,!0)},lt.prototype.once=function(t,e){return dt(e),this.on(t,mt(this,t,e)),this},lt.prototype.prependOnceListener=function(t,e){return dt(e),this.prependListener(t,mt(this,t,e)),this},lt.prototype.off=lt.prototype.removeListener=function(t,e){var r,n,i,o,s;if(dt(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},lt.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},lt.prototype.listeners=function(t){return bt(this,t,!0)},lt.prototype.rawListeners=function(t){return bt(this,t,!1)},lt.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):vt.call(t,e)},lt.prototype.listenerCount=vt,lt.prototype.eventNames=function(){return this._eventsCount>0?et(this._events):[]},ht.once=function(t,e){return new Promise(function(r,n){function i(r){t.removeListener(e,o),n(r)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),r([].slice.call(arguments))}_t(t,e,o,{once:!0}),"error"!==e&&function(t,e,r){"function"==typeof t.on&&_t(t,"error",e,{once:!0})}(t,i)})};var Et=ht.EventEmitter;function St(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function Tt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Rt=it.Buffer,At=V.inspect,Ct=At&&At.custom||"inspect";function kt(t,e,r){Rt.prototype.copy.call(t,e,r)}var It=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}var e;return(e=[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,r=""+e.data;e=e.next;)r+=t+e.data;return r}},{key:"concat",value:function(t){if(0===this.length)return Rt.alloc(0);for(var e=Rt.allocUnsafe(t>>>0),r=this.head,n=0;r;)kt(r.data,e,n),n+=r.data.length,r=r.next;return e}},{key:"consume",value:function(t,e){var r;return t<this.head.data.length?(r=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):r=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,r=1,n=e.data;for(t-=n.length;e=e.next;){var i=e.data,o=t>i.length?i.length:t;if(n+=o===i.length?i:i.slice(0,t),0==(t-=o)){o===i.length?(++r,this.head=e.next?e.next:this.tail=null):(this.head=e,e.data=i.slice(o));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(t){var e=Rt.allocUnsafe(t),r=this.head,n=1;for(r.data.copy(e),t-=r.data.length;r=r.next;){var i=r.data,o=t>i.length?i.length:t;if(i.copy(e,e.length-t,0,o),0==(t-=o)){o===i.length?(++n,this.head=r.next?r.next:this.tail=null):(this.head=r,r.data=i.slice(o));break}++n}return this.length-=n,e}},{key:Ct,value:function(t,e){return At(this,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?St(Object(r),!0).forEach(function(e){Tt(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):St(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},e,{depth:0,customInspect:!1}))}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(t.prototype,e),t}();function Ot(t,e){Bt(t,e),Mt(t)}function Mt(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function Bt(t,e){t.emit("error",e)}var xt=function(t,e){var r=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Bt,this,t)):process.nextTick(Bt,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?r._writableState?r._writableState.errorEmitted?process.nextTick(Mt,r):(r._writableState.errorEmitted=!0,process.nextTick(Ot,r,t)):process.nextTick(Ot,r,t):e?(process.nextTick(Mt,r),e(t)):process.nextTick(Mt,r)}),this)},Nt=function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},Lt=function(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)},Dt={};function Pt(t,e,r){r||(r=Error);var n=function(t){var r,n;function i(r,n,i){return t.call(this,function(t,r,n){return"string"==typeof e?e:e(t,r,n)}(r,n,i))||this}return n=t,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);n.prototype.name=r.name,n.prototype.code=t,Dt[t]=n}function jt(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(t){return String(t)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:2===r?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}Pt("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError),Pt("ERR_INVALID_ARG_TYPE",function(t,e,r){var n,i,o,s;if("string"==typeof e&&"not "===e.substr(0,"not ".length)?(n="must not be",e=e.replace(/^not /,"")):n="must be",function(t,e,r){return(void 0===r||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}(t," argument"))i="The ".concat(t," ").concat(n," ").concat(jt(e,"type"));else{var a=("number"!=typeof s&&(s=0),s+".".length>(o=t).length||-1===o.indexOf(".",s)?"argument":"property");i='The "'.concat(t,'" ').concat(a," ").concat(n," ").concat(jt(e,"type"))}return i+". Received type ".concat(typeof r)},TypeError),Pt("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),Pt("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"}),Pt("ERR_STREAM_PREMATURE_CLOSE","Premature close"),Pt("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"}),Pt("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),Pt("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),Pt("ERR_STREAM_WRITE_AFTER_END","write after end"),Pt("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),Pt("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError),Pt("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");var Ft={codes:Dt},Ut=Ft.codes.ERR_INVALID_OPT_VALUE,qt=function(t,e,r,n){var i=function(t,e,r){return null!=t.highWaterMark?t.highWaterMark:e?t[r]:null}(e,n,r);if(null!=i){if(!isFinite(i)||Math.floor(i)!==i||i<0)throw new Ut(n?r:"highWaterMark",i);return Math.floor(i)}return t.objectMode?16:16384},Gt=E(function(t){t.exports="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}});function $t(t){try{if(!_.localStorage)return!1}catch(t){return!1}var e=_.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}var Kt,Ht=le;function Vt(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(void 0),n=n.next}e.corkedRequestsFree.next=t}(e,t)}}le.WritableState=ce;var Wt,zt=function(t,e){if($t("noDeprecation"))return t;var r=!1;return function(){if(!r){if($t("throwDeprecation"))throw new Error(e);$t("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}},Yt=it.Buffer,Zt=_.Uint8Array||function(){},Jt=qt,Xt=Ft.codes,Qt=Xt.ERR_INVALID_ARG_TYPE,te=Xt.ERR_METHOD_NOT_IMPLEMENTED,ee=Xt.ERR_MULTIPLE_CALLBACK,re=Xt.ERR_STREAM_CANNOT_PIPE,ne=Xt.ERR_STREAM_DESTROYED,ie=Xt.ERR_STREAM_NULL_VALUES,oe=Xt.ERR_STREAM_WRITE_AFTER_END,se=Xt.ERR_UNKNOWN_ENCODING,ae=Lt;function ue(){}function ce(t,e,r){Kt=Kt||be,"boolean"!=typeof r&&(r=e instanceof Kt),this.objectMode=!!(t=t||{}).objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=Jt(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===t.decodeStrings),this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if("function"!=typeof i)throw new ee;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(r),e)!function(t,e,r,n,i){--e.pendingcb,r?(process.nextTick(i,n),process.nextTick(ge,t,e),t._writableState.errorEmitted=!0,ae(t,n)):(i(n),t._writableState.errorEmitted=!0,ae(t,n),ge(t,e))}(t,r,n,e,i);else{var o=pe(r)||t.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||de(t,r),n?process.nextTick(fe,t,r,o,i):fe(t,r,o,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Vt(this)}function le(t){var e=this instanceof(Kt=Kt||be);if(!e&&!Wt.call(le,this))return new le(t);this._writableState=new ce(t,this,e),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),Et.call(this)}function he(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new ne("write")):r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function fe(t,e,r,n){r||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,n(),ge(t,e)}function de(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=new Array(e.bufferedRequestCount),i=e.corkedRequestsFree;i.entry=r;for(var o=0,s=!0;r;)n[o]=r,r.isBuf||(s=!1),r=r.next,o+=1;n.allBuffers=s,he(t,e,!0,e.length,n,"",i.finish),e.pendingcb++,e.lastBufferedRequest=null,i.next?(e.corkedRequestsFree=i.next,i.next=null):e.corkedRequestsFree=new Vt(e),e.bufferedRequestCount=0}else{for(;r;){var a=r.chunk;if(he(t,e,!1,e.objectMode?1:a.length,a,r.encoding,r.callback),r=r.next,e.bufferedRequestCount--,e.writing)break}null===r&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}function pe(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function ye(t,e){t._final(function(r){e.pendingcb--,r&&ae(t,r),e.prefinished=!0,t.emit("prefinish"),ge(t,e)})}function ge(t,e){var r=pe(e);if(r&&(function(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,process.nextTick(ye,t,e)))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}Gt(le,Et),ce.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(ce.prototype,"buffer",{get:zt(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Wt=Function.prototype[Symbol.hasInstance],Object.defineProperty(le,Symbol.hasInstance,{value:function(t){return!!Wt.call(this,t)||this===le&&t&&t._writableState instanceof ce}})):Wt=function(t){return t instanceof this},le.prototype.pipe=function(){ae(this,new re)},le.prototype.write=function(t,e,r){var n,i=this._writableState,o=!1,s=!i.objectMode&&(Yt.isBuffer(n=t)||n instanceof Zt);return s&&!Yt.isBuffer(t)&&(t=function(t){return Yt.from(t)}(t)),"function"==typeof e&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof r&&(r=ue),i.ending?function(t,e){var r=new oe;ae(t,r),process.nextTick(e,r)}(this,r):(s||function(t,e,r,n){var i;return null===r?i=new ie:"string"==typeof r||e.objectMode||(i=new Qt("chunk",["string","Buffer"],r)),!i||(ae(t,i),process.nextTick(n,i),!1)}(this,i,t,r))&&(i.pendingcb++,o=function(t,e,r,n,i,o){if(!r){var s=function(t,e,r){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=Yt.from(e,r)),e}(e,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=e.objectMode?1:n.length;e.length+=a;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else he(t,e,!1,a,n,i,o);return u}(this,i,s,t,e,r)),o},le.prototype.cork=function(){this._writableState.corked++},le.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||de(this,t))},le.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new se(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(le.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(le.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),le.prototype._write=function(t,e,r){r(new te("_write()"))},le.prototype._writev=null,le.prototype.end=function(t,e,r){var n=this._writableState;return"function"==typeof t?(r=t,t=null,e=null):"function"==typeof e&&(r=e,e=null),null!=t&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||function(t,e,r){e.ending=!0,ge(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}(this,n,r),this},Object.defineProperty(le.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(le.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),le.prototype.destroy=xt,le.prototype._undestroy=Nt,le.prototype._destroy=function(t,e){e(t)};var me=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e},be=Ee;Gt(Ee,ir);for(var ve=me(Ht.prototype),we=0;we<ve.length;we++){var _e=ve[we];Ee.prototype[_e]||(Ee.prototype[_e]=Ht.prototype[_e])}function Ee(t){if(!(this instanceof Ee))return new Ee(t);ir.call(this,t),Ht.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",Se)))}function Se(){this._writableState.ended||process.nextTick(Te,this)}function Te(t){t.end()}Object.defineProperty(Ee.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Ee.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Ee.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Ee.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}});var Re=ot.Buffer,Ae=Re.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},Ce=ke;function ke(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(Re.isEncoding===Ae||!Ae(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=Me,this.end=Be,e=4;break;case"utf8":this.fillLast=Oe,e=4;break;case"base64":this.text=xe,this.end=Ne,e=3;break;default:return this.write=Le,void(this.end=De)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Re.allocUnsafe(e)}function Ie(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function Oe(t){var e=this.lastTotal-this.lastNeed,r=function(t,e,r){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function Me(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function Be(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):e}function xe(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function Ne(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Le(t){return t.toString(this.encoding)}function De(t){return t&&t.length?this.write(t):""}ke.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},ke.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},ke.prototype.text=function(t,e){var r=function(t,e,r){var n=e.length-1;if(n<r)return 0;var i=Ie(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||-2===i?0:(i=Ie(e[n]))>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||-2===i?0:(i=Ie(e[n]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},ke.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};var Pe={StringDecoder:Ce},je=Ft.codes.ERR_STREAM_PREMATURE_CLOSE;function Fe(){}var Ue,qe=function t(e,r,n){if("function"==typeof r)return t(e,null,r);r||(r={}),n=function(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}}(n||Fe);var i=r.readable||!1!==r.readable&&e.readable,o=r.writable||!1!==r.writable&&e.writable,s=function(){e.writable||u()},a=e._writableState&&e._writableState.finished,u=function(){o=!1,a=!0,i||n.call(e)},c=e._readableState&&e._readableState.endEmitted,l=function(){i=!1,c=!0,o||n.call(e)},h=function(t){n.call(e,t)},f=function(){var t;return i&&!c?(e._readableState&&e._readableState.ended||(t=new je),n.call(e,t)):o&&!a?(e._writableState&&e._writableState.ended||(t=new je),n.call(e,t)):void 0},d=function(){e.req.on("finish",u)};return function(t){return t.setHeader&&"function"==typeof t.abort}(e)?(e.on("complete",u),e.on("abort",f),e.req?d():e.on("request",d)):o&&!e._writableState&&(e.on("end",s),e.on("close",s)),e.on("end",l),e.on("finish",u),!1!==r.error&&e.on("error",h),e.on("close",f),function(){e.removeListener("complete",u),e.removeListener("abort",f),e.removeListener("request",d),e.req&&e.req.removeListener("finish",u),e.removeListener("end",s),e.removeListener("close",s),e.removeListener("finish",u),e.removeListener("end",l),e.removeListener("error",h),e.removeListener("close",f)}};function Ge(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var $e=Symbol("lastResolve"),Ke=Symbol("lastReject"),He=Symbol("error"),Ve=Symbol("ended"),We=Symbol("lastPromise"),ze=Symbol("handlePromise"),Ye=Symbol("stream");function Ze(t,e){return{value:t,done:e}}function Je(t){var e=t[$e];if(null!==e){var r=t[Ye].read();null!==r&&(t[We]=null,t[$e]=null,t[Ke]=null,e(Ze(r,!1)))}}function Xe(t){process.nextTick(Je,t)}var Qe,tr=Object.getPrototypeOf(function(){}),er=Object.setPrototypeOf((Ge(Ue={get stream(){return this[Ye]},next:function(){var t=this,e=this[He];if(null!==e)return Promise.reject(e);if(this[Ve])return Promise.resolve(Ze(void 0,!0));if(this[Ye].destroyed)return new Promise(function(e,r){process.nextTick(function(){t[He]?r(t[He]):e(Ze(void 0,!0))})});var r,n=this[We];if(n)r=new Promise(function(t,e){return function(r,n){t.then(function(){e[Ve]?r(Ze(void 0,!0)):e[ze](r,n)},n)}}(n,this));else{var i=this[Ye].read();if(null!==i)return Promise.resolve(Ze(i,!1));r=new Promise(this[ze])}return this[We]=r,r}},Symbol.asyncIterator,function(){return this}),Ge(Ue,"return",function(){var t=this;return new Promise(function(e,r){t[Ye].destroy(null,function(t){t?r(t):e(Ze(void 0,!0))})})}),Ue),tr),rr=function(t){var e,r=Object.create(er,(Ge(e={},Ye,{value:t,writable:!0}),Ge(e,$e,{value:null,writable:!0}),Ge(e,Ke,{value:null,writable:!0}),Ge(e,He,{value:null,writable:!0}),Ge(e,Ve,{value:t._readableState.endEmitted,writable:!0}),Ge(e,ze,{value:function(t,e){var n=r[Ye].read();n?(r[We]=null,r[$e]=null,r[Ke]=null,t(Ze(n,!1))):(r[$e]=t,r[Ke]=e)},writable:!0}),e));return r[We]=null,qe(t,function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=r[Ke];return null!==e&&(r[We]=null,r[$e]=null,r[Ke]=null,e(t)),void(r[He]=t)}var n=r[$e];null!==n&&(r[We]=null,r[$e]=null,r[Ke]=null,n(Ze(void 0,!0))),r[Ve]=!0}),t.on("readable",Xe.bind(null,r)),r},nr=function(){throw new Error("Readable.from is not available in the browser")},ir=_r;_r.ReadableState=wr;var or,sr=function(t,e){return t.listeners(e).length},ar=it.Buffer,ur=_.Uint8Array||function(){};or=V&&V.debuglog?V.debuglog("stream"):function(){};var cr,lr,hr,fr=qt,dr=Ft.codes,pr=dr.ERR_INVALID_ARG_TYPE,yr=dr.ERR_STREAM_PUSH_AFTER_EOF,gr=dr.ERR_METHOD_NOT_IMPLEMENTED,mr=dr.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;Gt(_r,Et);var br=Lt,vr=["error","close","destroy","pause","resume"];function wr(t,e,r){Qe=Qe||be,"boolean"!=typeof r&&(r=e instanceof Qe),this.objectMode=!!(t=t||{}).objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=fr(this,t,"readableHighWaterMark",r),this.buffer=new It,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(cr||(cr=Pe.StringDecoder),this.decoder=new cr(t.encoding),this.encoding=t.encoding)}function _r(t){if(Qe=Qe||be,!(this instanceof _r))return new _r(t);this._readableState=new wr(t,this,this instanceof Qe),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),Et.call(this)}function Er(t,e,r,n,i){or("readableAddChunk",e);var o,s=t._readableState;if(null===e)s.reading=!1,function(t,e){if(or("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?Rr(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Ar(t)))}}(t,s);else if(i||(o=function(t,e){var r,n;return ar.isBuffer(n=e)||n instanceof ur||"string"==typeof e||void 0===e||t.objectMode||(r=new pr("chunk",["string","Buffer","Uint8Array"],e)),r}(s,e)),o)br(t,o);else if(s.objectMode||e&&e.length>0)if("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===ar.prototype||(e=function(t){return ar.from(t)}(e)),n)s.endEmitted?br(t,new mr):Sr(t,s,e,!0);else if(s.ended)br(t,new yr);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||0!==e.length?Sr(t,s,e,!1):Cr(t,s)):Sr(t,s,e,!1)}else n||(s.reading=!1,Cr(t,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function Sr(t,e,r,n){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&Rr(t)),Cr(t,e)}function Tr(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=1073741824?t=1073741824:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function Rr(t){var e=t._readableState;or("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(or("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Ar,t))}function Ar(t){var e=t._readableState;or("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,Br(t)}function Cr(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(kr,t,e))}function kr(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var r=e.length;if(or("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}function Ir(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function Or(t){or("readable nexttick read 0"),t.read(0)}function Mr(t,e){or("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),Br(t),e.flowing&&!e.reading&&t.read(0)}function Br(t){var e=t._readableState;for(or("flow",e.flowing);e.flowing&&null!==t.read(););}function xr(t,e){return 0===e.length?null:(e.objectMode?r=e.buffer.shift():!t||t>=e.length?(r=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r);var r}function Nr(t){var e=t._readableState;or("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(Lr,e,t))}function Lr(t,e){if(or("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}function Dr(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}Object.defineProperty(_r.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),_r.prototype.destroy=xt,_r.prototype._undestroy=Nt,_r.prototype._destroy=function(t,e){e(t)},_r.prototype.push=function(t,e){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof t&&((e=e||n.defaultEncoding)!==n.encoding&&(t=ar.from(t,e),e=""),r=!0),Er(this,t,e,!1,r)},_r.prototype.unshift=function(t){return Er(this,t,null,!0,!1)},_r.prototype.isPaused=function(){return!1===this._readableState.flowing},_r.prototype.setEncoding=function(t){cr||(cr=Pe.StringDecoder);var e=new cr(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";null!==r;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this},_r.prototype.read=function(t){or("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return or("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?Nr(this):Rr(this),null;if(0===(t=Tr(t,e))&&e.ended)return 0===e.length&&Nr(this),null;var n,i=e.needReadable;return or("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&or("length less than watermark",i=!0),e.ended||e.reading?or("reading or ended",i=!1):i&&(or("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=Tr(r,e))),null===(n=t>0?xr(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&Nr(this)),null!==n&&this.emit("data",n),n},_r.prototype._read=function(t){br(this,new gr("_read()"))},_r.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t)}n.pipesCount+=1,or("pipe count=%d opts=%j",n.pipesCount,e);var i=e&&!1===e.end||t===process.stdout||t===process.stderr?f:o;function o(){or("onend"),t.end()}n.endEmitted?process.nextTick(i):r.once("end",i),t.on("unpipe",function e(i,d){or("onunpipe"),i===r&&d&&!1===d.hasUnpiped&&(d.hasUnpiped=!0,or("cleanup"),t.removeListener("close",l),t.removeListener("finish",h),t.removeListener("drain",s),t.removeListener("error",c),t.removeListener("unpipe",e),r.removeListener("end",o),r.removeListener("end",f),r.removeListener("data",u),a=!0,!n.awaitDrain||t._writableState&&!t._writableState.needDrain||s())});var s=function(t){return function(){var e=t._readableState;or("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&sr(t,"data")&&(e.flowing=!0,Br(t))}}(r);t.on("drain",s);var a=!1;function u(e){or("ondata");var i=t.write(e);or("dest.write",i),!1===i&&((1===n.pipesCount&&n.pipes===t||n.pipesCount>1&&-1!==Dr(n.pipes,t))&&!a&&(or("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function c(e){or("onerror",e),f(),t.removeListener("error",c),0===sr(t,"error")&&br(t,e)}function l(){t.removeListener("finish",h),f()}function h(){or("onfinish"),t.removeListener("close",l),f()}function f(){or("unpipe"),r.unpipe(t)}return r.on("data",u),function(t,e,r){if("function"==typeof t.prependListener)return t.prependListener(e,r);t._events&&t._events.error?Array.isArray(t._events.error)?t._events.error.unshift(r):t._events.error=[r,t._events.error]:t.on(e,r)}(t,"error",c),t.once("close",l),t.once("finish",h),t.emit("pipe",r),n.flowing||(or("pipe resume"),r.resume()),t},_r.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r)),this;if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=Dr(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r)),this},_r.prototype.addListener=_r.prototype.on=function(t,e){var r=Et.prototype.on.call(this,t,e),n=this._readableState;return"data"===t?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===t&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,or("on readable",n.length,n.reading),n.length?Rr(this):n.reading||process.nextTick(Or,this))),r},_r.prototype.removeListener=function(t,e){var r=Et.prototype.removeListener.call(this,t,e);return"readable"===t&&process.nextTick(Ir,this),r},_r.prototype.removeAllListeners=function(t){var e=Et.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||process.nextTick(Ir,this),e},_r.prototype.resume=function(){var t=this._readableState;return t.flowing||(or("resume"),t.flowing=!t.readableListening,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(Mr,t,e))}(this,t)),t.paused=!1,this},_r.prototype.pause=function(){return or("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(or("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},_r.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;for(var i in t.on("end",function(){if(or("wrapped end"),r.decoder&&!r.ended){var t=r.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(i){or("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(e.push(i)||(n=!0,t.pause()))}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<vr.length;o++)t.on(vr[o],this.emit.bind(this,vr[o]));return this._read=function(e){or("wrapped _read",e),n&&(n=!1,t.resume())},this},"function"==typeof Symbol&&(_r.prototype[Symbol.asyncIterator]=function(){return void 0===lr&&(lr=rr),lr(this)}),Object.defineProperty(_r.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(_r.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(_r.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),_r._fromList=xr,Object.defineProperty(_r.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(_r.from=function(t,e){return void 0===hr&&(hr=nr),hr(_r,t,e)});var Pr=Kr,jr=Ft.codes,Fr=jr.ERR_METHOD_NOT_IMPLEMENTED,Ur=jr.ERR_MULTIPLE_CALLBACK,qr=jr.ERR_TRANSFORM_ALREADY_TRANSFORMING,Gr=jr.ERR_TRANSFORM_WITH_LENGTH_0;function $r(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new Ur);r.writechunk=null,r.writecb=null,null!=e&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Kr(t){if(!(this instanceof Kr))return new Kr(t);be.call(this,t),this._transformState={afterTransform:$r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",Hr)}function Hr(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?Vr(this,null,null):this._flush(function(e,r){Vr(t,e,r)})}function Vr(t,e,r){if(e)return t.emit("error",e);if(null!=r&&t.push(r),t._writableState.length)throw new Gr;if(t._transformState.transforming)throw new qr;return t.push(null)}Gt(Kr,be),Kr.prototype.push=function(t,e){return this._transformState.needTransform=!1,be.prototype.push.call(this,t,e)},Kr.prototype._transform=function(t,e,r){r(new Fr("_transform()"))},Kr.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Kr.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},Kr.prototype._destroy=function(t,e){be.prototype._destroy.call(this,t,function(t){e(t)})};var Wr,zr=Yr;function Yr(t){if(!(this instanceof Yr))return new Yr(t);Pr.call(this,t)}Gt(Yr,Pr),Yr.prototype._transform=function(t,e,r){r(null,t)};var Zr=Ft.codes,Jr=Zr.ERR_MISSING_ARGS,Xr=Zr.ERR_STREAM_DESTROYED;function Qr(t){if(t)throw t}function tn(t,e,r,n){n=function(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}(n);var i=!1;t.on("close",function(){i=!0}),void 0===Wr&&(Wr=qe),Wr(t,{readable:e,writable:r},function(t){if(t)return n(t);i=!0,n()});var o=!1;return function(e){if(!i&&!o)return o=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void n(e||new Xr("pipe"))}}function en(t){t()}function rn(t,e){return t.pipe(e)}function nn(t){return t.length?"function"!=typeof t[t.length-1]?Qr:t.pop():Qr}var on=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n,i=nn(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Jr("streams");var o=e.map(function(t,r){var s=r<e.length-1;return tn(t,s,r>0,function(t){n||(n=t),t&&o.forEach(en),s||(o.forEach(en),i(n))})});return e.reduce(rn)},sn=E(function(t,e){(e=t.exports=ir).Stream=e,e.Readable=e,e.Writable=Ht,e.Duplex=be,e.Transform=Pr,e.PassThrough=zr,e.finished=qe,e.pipeline=on});let an;var un="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:_):t=>(an||(an=Promise.resolve())).then(t).catch(t=>setTimeout(()=>{throw t},0));function cn(t,e){for(const r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}var ln=function(t,e,r){if(!t||"string"==typeof t)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"==typeof e&&(r=e,e=void 0),null!=e&&(r.code=e);try{return cn(t,r)}catch(e){r.message=t.message,r.stack=t.stack;const n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),cn(new n,r)}},hn=$("simple-peer");function fn(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}class dn extends sn.Duplex{constructor(t){if(super(t=Object.assign({allowHalfOpen:!1},t)),this._id=st(4).toString("hex").slice(0,7),this._debug("new peer %o",t),this.channelName=t.initiator?t.channelName||st(20).toString("hex"):null,this.initiator=t.initiator||!1,this.channelConfig=t.channelConfig||dn.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},dn.config,t.config),this.offerOptions=t.offerOptions||{},this.answerOptions=t.answerOptions||{},this.sdpTransform=t.sdpTransform||(t=>t),this.streams=t.streams||(t.stream?[t.stream]:[]),this.trickle=void 0===t.trickle||t.trickle,this.allowHalfTrickle=void 0!==t.allowHalfTrickle&&t.allowHalfTrickle,this.iceCompleteTimeout=t.iceCompleteTimeout||5e3,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=t.wrtc&&"object"==typeof t.wrtc?t.wrtc:W(),!this._wrtc)throw"undefined"==typeof window?ln(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):ln(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!this.negotiated&&!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){return void un(()=>this.destroy(ln(t,"ERR_PC_CONSTRUCTOR")))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=t=>{this._onIceCandidate(t)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=t=>{this._setupData(t)},this.streams&&this.streams.forEach(t=>{this.addStream(t)}),this._pc.ontrack=t=>{this._onTrack(t)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(t){if(this.destroyed)throw ln(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t={}}this._debug("signal()"),t.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),t.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(t.transceiverRequest.kind,t.transceiverRequest.init)),t.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(t.candidate):this._pendingCandidates.push(t.candidate)),t.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(t)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(t=>{this._addIceCandidate(t)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(t=>{this.destroy(ln(t,"ERR_SET_REMOTE_DESCRIPTION"))}),t.sdp||t.candidate||t.renegotiate||t.transceiverRequest||this.destroy(ln(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(t){var e=new this._wrtc.RTCIceCandidate(t);this._pc.addIceCandidate(e).catch(t=>{!e.address||e.address.endsWith(".local")?console.warn("Ignoring unsupported ICE candidate."):this.destroy(ln(t,"ERR_ADD_ICE_CANDIDATE"))})}send(t){this._channel.send(t)}addTransceiver(t,e){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(t,e),this._needsNegotiation()}catch(t){this.destroy(ln(t,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:t,init:e}})}addStream(t){this._debug("addStream()"),t.getTracks().forEach(e=>{this.addTrack(e,t)})}addTrack(t,e){this._debug("addTrack()");var r=this._senderMap.get(t)||new Map,n=r.get(e);if(n)throw n.removed?ln(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):ln(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");n=this._pc.addTrack(t,e),r.set(e,n),this._senderMap.set(t,r),this._needsNegotiation()}replaceTrack(t,e,r){this._debug("replaceTrack()");var n=this._senderMap.get(t),i=n?n.get(r):null;if(!i)throw ln(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");e&&this._senderMap.set(e,n),null!=i.replaceTrack?i.replaceTrack(e):this.destroy(ln(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(t,e){this._debug("removeSender()");var r=this._senderMap.get(t),n=r?r.get(e):null;if(!n)throw ln(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(t){"NS_ERROR_UNEXPECTED"===t.name?this._sendersAwaitingStable.push(n):this.destroy(ln(t,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(t){this._debug("removeSenders()"),t.getTracks().forEach(e=>{this.removeTrack(e,t)})}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,un(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(t,e){if(this._debug("destroy (error: %s)",t&&(t.message||t)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(t){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(t){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e(t)}_setupData(t){if(!t.channel)return this.destroy(ln(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=t.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=65536),this.channelName=this._channel.label,this._channel.onmessage=t=>{this._onChannelMessage(t)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=t=>{this.destroy(ln(t,"ERR_DATA_CHANNEL"))};var e=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(e&&this._onChannelClose(),e=!0):e=!1},5e3)}_read(){}_write(t,e,r){if(this.destroyed)return r(ln(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(t)}catch(t){return this.destroy(ln(t,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>65536?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=r):r(null)}else this._debug("write before connect"),this._chunk=t,this._cb=r}_onFinish(){if(this.destroyed)return;const t=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?t():this.once("connect",t)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(t=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(t.sdp=fn(t.sdp)),t.sdp=this.sdpTransform(t.sdp);const e=()=>{if(!this.destroyed){var e=this._pc.localDescription||t;this._debug("signal"),this.emit("signal",{type:e.type,sdp:e.sdp})}};this._pc.setLocalDescription(t).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?e():this.once("_iceComplete",e))}).catch(t=>{this.destroy(ln(t,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(t=>{this.destroy(ln(t,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(t=>{t.mid||!t.sender.track||t.requested||(t.requested=!0,this.addTransceiver(t.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(t=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(t.sdp=fn(t.sdp)),t.sdp=this.sdpTransform(t.sdp);const e=()=>{if(!this.destroyed){var e=this._pc.localDescription||t;this._debug("signal"),this.emit("signal",{type:e.type,sdp:e.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(t).then(()=>{this.destroyed||(this.trickle||this._iceComplete?e():this.once("_iceComplete",e))}).catch(t=>{this.destroy(ln(t,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(t=>{this.destroy(ln(t,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(ln(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var t=this._pc.iceConnectionState,e=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",t,e),this.emit("iceStateChange",t,e),"connected"!==t&&"completed"!==t||(this._pcReady=!0,this._maybeReady()),"failed"===t&&this.destroy(ln(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===t&&this.destroy(ln(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(t){const e=t=>("[object Array]"===Object.prototype.toString.call(t.values)&&t.values.forEach(e=>{Object.assign(t,e)}),t);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(r=>{var n=[];r.forEach(t=>{n.push(e(t))}),t(null,n)},e=>t(e)):this._pc.getStats.length>0?this._pc.getStats(r=>{if(!this.destroyed){var n=[];r.result().forEach(t=>{var r={};t.names().forEach(e=>{r[e]=t.stat(e)}),r.id=t.id,r.type=t.type,r.timestamp=t.timestamp,n.push(e(r))}),t(null,n)}},e=>t(e)):t(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const t=()=>{this.destroyed||this.getStats((e,r)=>{if(this.destroyed)return;e&&(r=[]);var n={},i={},o={},s=!1;r.forEach(t=>{"remotecandidate"!==t.type&&"remote-candidate"!==t.type||(n[t.id]=t),"localcandidate"!==t.type&&"local-candidate"!==t.type||(i[t.id]=t),"candidatepair"!==t.type&&"candidate-pair"!==t.type||(o[t.id]=t)});const a=t=>{s=!0;var e=i[t.localCandidateId];e&&(e.ip||e.address)?(this.localAddress=e.ip||e.address,this.localPort=Number(e.port)):e&&e.ipAddress?(this.localAddress=e.ipAddress,this.localPort=Number(e.portNumber)):"string"==typeof t.googLocalAddress&&(e=t.googLocalAddress.split(":"),this.localAddress=e[0],this.localPort=Number(e[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var r=n[t.remoteCandidateId];r&&(r.ip||r.address)?(this.remoteAddress=r.ip||r.address,this.remotePort=Number(r.port)):r&&r.ipAddress?(this.remoteAddress=r.ipAddress,this.remotePort=Number(r.portNumber)):"string"==typeof t.googRemoteAddress&&(r=t.googRemoteAddress.split(":"),this.remoteAddress=r[0],this.remotePort=Number(r[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(r.forEach(t=>{"transport"===t.type&&t.selectedCandidatePairId&&a(o[t.selectedCandidatePairId]),("googCandidatePair"===t.type&&"true"===t.googActiveConnection||("candidatepair"===t.type||"candidate-pair"===t.type)&&t.selected)&&a(t)}),s||Object.keys(o).length&&!Object.keys(i).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(e){return this.destroy(ln(e,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var u=this._cb;this._cb=null,u(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(t,100)})};t()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>65536||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"!==this._pc.signalingState||this._firstStable||(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(t=>{this._pc.removeTrack(t),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(t){this.destroyed||(t.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:t.candidate.candidate,sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid}}):t.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),t.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(t){if(!this.destroyed){var e=t.data;e instanceof ArrayBuffer&&(e=new Uint8Array(e)),this.push(e)}}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var t=this._cb;this._cb=null,t(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(t){this.destroyed||t.streams.forEach(e=>{this._debug("on track"),this.emit("track",t.track,e),this._remoteTracks.push({track:t.track,stream:e}),this._remoteStreams.some(t=>t.id===e.id)||(this._remoteStreams.push(e),un(()=>{this.emit("stream",e)}))})}_debug(){var t=[].slice.call(arguments);t[0]="["+this._id+"] "+t[0],hn.apply(null,t)}}dn.WEBRTC_SUPPORT=!!W(),dn.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},dn.channelConfig={};var pn=dn;const{Multiaddr:yn}=l,gn=$n("dns4"),mn=$n("dns6"),bn=$n("dnsaddr"),vn=Gn($n("dns"),bn,gn,mn),wn=Gn($n("ip4"),$n("ip6")),_n=Gn(qn(wn,$n("tcp")),qn(vn,$n("tcp"))),En=qn(wn,$n("udp")),Sn=qn(En,$n("utp")),Tn=qn(En,$n("quic")),Rn=Gn(qn(_n,$n("ws")),qn(vn,$n("ws"))),An=Gn(qn(_n,$n("wss")),qn(vn,$n("wss"))),Cn=Gn(qn(_n,$n("http")),qn(wn,$n("http")),qn(vn,$n("http"))),kn=Gn(qn(_n,$n("https")),qn(wn,$n("https")),qn(vn,$n("https"))),In=Gn(qn(Rn,$n("p2p-webrtc-star"),$n("p2p")),qn(An,$n("p2p-webrtc-star"),$n("p2p")),qn(Rn,$n("p2p-webrtc-star")),qn(An,$n("p2p-webrtc-star"))),On=Gn(qn(Rn,$n("p2p-websocket-star"),$n("p2p")),qn(An,$n("p2p-websocket-star"),$n("p2p")),qn(Rn,$n("p2p-websocket-star")),qn(An,$n("p2p-websocket-star"))),Mn=Gn(qn(Cn,$n("p2p-webrtc-direct"),$n("p2p")),qn(kn,$n("p2p-webrtc-direct"),$n("p2p")),qn(Cn,$n("p2p-webrtc-direct")),qn(kn,$n("p2p-webrtc-direct"))),Bn=Gn(Rn,An,Cn,kn,In,Mn,_n,Sn,Tn,vn),xn=Gn(qn(Bn,$n("p2p-stardust"),$n("p2p")),qn(Bn,$n("p2p-stardust"))),Nn=Gn(qn(Bn,$n("p2p")),In,Mn,$n("p2p")),Ln=Gn(qn(Nn,$n("p2p-circuit"),Nn),qn(Nn,$n("p2p-circuit")),qn($n("p2p-circuit"),Nn),qn(Bn,$n("p2p-circuit")),qn($n("p2p-circuit"),Bn),$n("p2p-circuit")),Dn=()=>Gn(qn(Ln,Dn),Ln),Pn=Dn(),jn=Gn(qn(Pn,Nn,Pn),qn(Nn,Pn),qn(Pn,Nn),Pn,Nn);var Fn={DNS:vn,DNS4:gn,DNS6:mn,DNSADDR:bn,IP:wn,TCP:_n,UDP:En,QUIC:Tn,UTP:Sn,HTTP:Cn,HTTPS:kn,WebSockets:Rn,WebSocketsSecure:An,WebSocketStar:On,WebRTCStar:In,WebRTCDirect:Mn,Reliable:Bn,Stardust:xn,Circuit:Pn,P2P:jn,IPFS:jn};function Un(t){return function(e){if(!yn.isMultiaddr(e))try{e=new yn(e)}catch(t){return!1}const r=t(e.protoNames());return null!==r&&(!0===r||!1===r?r:0===r.length)}}function qn(...t){function e(e){if(e.length<t.length)return null;let r=e;return t.some(t=>(r="function"==typeof t?t().partialMatch(e):t.partialMatch(e),Array.isArray(r)&&(e=r),null===r)),r}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Un(e),partialMatch:e}}function Gn(...t){function e(e){let r=null;return t.some(t=>{const n="function"==typeof t?t().partialMatch(e):t.partialMatch(e);return!!n&&(r=n,!0)}),r}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Un(e),partialMatch:e}}function $n(t){const e=t;return{toString:function(){return e},matches:function(t){if("string"==typeof t)try{t=new yn(t)}catch(t){return!1}const r=t.protoNames();return 1===r.length&&r[0]===e},partialMatch:function(t){return 0===t.length?null:t[0]===e?t.slice(1):null}}}var Kn=function(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),r=0;r<e.length;r++)e[r]=255;for(var n=0;n<t.length;n++){var i=t.charAt(n),o=i.charCodeAt(0);if(255!==e[o])throw new TypeError(i+" is ambiguous");e[o]=n}var s=t.length,a=t.charAt(0),u=Math.log(s)/Math.log(256),c=Math.log(256)/Math.log(s);function l(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var r=0;if(" "!==t[r]){for(var n=0,i=0;t[r]===a;)n++,r++;for(var o=(t.length-r)*u+1>>>0,c=new Uint8Array(o);t[r];){var l=e[t.charCodeAt(r)];if(255===l)return;for(var h=0,f=o-1;(0!==l||h<i)&&-1!==f;f--,h++)c[f]=(l+=s*c[f]>>>0)%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,r++}if(" "!==t[r]){for(var d=o-i;d!==o&&0===c[d];)d++;for(var p=new Uint8Array(n+(o-d)),y=n;d!==o;)p[y++]=c[d++];return p}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var u=(o-i)*c+1>>>0,l=new Uint8Array(u);i!==o;){for(var h=e[i],f=0,d=u-1;(0!==h||f<n)&&-1!==d;d--,f++)l[d]=(h+=256*l[d]>>>0)%s>>>0,h=h/s>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=u-n;p!==u&&0===l[p];)p++;for(var y=a.repeat(r);p<u;++p)y+=t.charAt(l[p]);return y},decodeUnsafe:l,decode:function(t){var e=l(t);if(e)return e;throw new Error("Non-base"+s+" character")}}};const Hn=new TextDecoder,Vn=new TextEncoder;var Wn={decodeText:t=>Hn.decode(t),encodeText:t=>Vn.encode(t),concat:function(t,e){const r=new Uint8Array(e);let n=0;for(const e of t)r.set(e,n),n+=e.length;return r}};const{encodeText:zn}=Wn;var Yn={rfc4648:t=>e=>({encode:r=>((t,e,r)=>{const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(r,e,t),decode:r=>((t,e,r)=>{const n={};for(let t=0;t<e.length;++t)n[e[t]]=t;let i=t.length;for(;"="===t[i-1];)--i;const o=new Uint8Array(i*r/8|0);let s=0,a=0,u=0;for(let e=0;e<i;++e){const i=n[t[e]];if(void 0===i)throw new SyntaxError("Invalid character "+t[e]);a=a<<r|i,s+=r,s>=8&&(s-=8,o[u++]=255&a>>s)}if(s>=r||255&a<<8-s)throw new SyntaxError("Unexpected end of data");return o})(r,e,t)})};const{rfc4648:Zn}=Yn,{decodeText:Jn,encodeText:Xn}=Wn,Qn=[["identity","\0",()=>({encode:Jn,decode:Xn}),""],["base2","0",Zn(1),"01"],["base8","7",Zn(3),"01234567"],["base10","9",Kn,"0123456789"],["base16","f",Zn(4),"0123456789abcdef"],["base16upper","F",Zn(4),"0123456789ABCDEF"],["base32hex","v",Zn(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",Zn(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",Zn(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",Zn(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",Zn(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",Zn(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",Zn(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",Zn(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",Zn(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",Kn,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",Kn,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",Kn,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",Kn,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",Zn(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",Zn(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",Zn(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",Zn(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],ti=Qn.reduce((t,e)=>(t[e[0]]=new class{constructor(t,e,r,n){this.name=t,this.code=e,this.codeBuf=zn(this.code),this.alphabet=n,this.codec=r(n)}encode(t){return this.codec.encode(t)}decode(t){for(const e of t)if(this.alphabet&&this.alphabet.indexOf(e)<0)throw new Error(`invalid character '${e}' in '${t}'`);return this.codec.decode(t)}}(e[0],e[1],e[2],e[3]),t),{}),ei=Qn.reduce((t,e)=>(t[e[1]]=ti[e[0]],t),{});var ri={names:ti,codes:ei},ni=E(function(t,e){const{encodeText:r,decodeText:n,concat:i}=Wn;function o(t){if(Object.prototype.hasOwnProperty.call(ri.names,t))return ri.names[t];if(Object.prototype.hasOwnProperty.call(ri.codes,t))return ri.codes[t];throw new Error(`Unsupported encoding: ${t}`)}(e=t.exports=function(t,e){if(!e)throw new Error("requires an encoded Uint8Array");const{name:r,codeBuf:s}=o(t);return function(t,e){o(t).decode(n(e))}(r,e),i([s,e],s.length+e.length)}).encode=function(t,e){const n=o(t),s=r(n.encode(e));return i([n.codeBuf,s],n.codeBuf.length+s.length)},e.decode=function(t){return t instanceof Uint8Array&&(t=n(t)),["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t[0])&&(t=t.toLowerCase()),o(t[0]).decode(t.substring(1))},e.isEncoded=function(t){if(t instanceof Uint8Array&&(t=n(t)),"[object String]"!==Object.prototype.toString.call(t))return!1;try{return o(t[0]).name}catch(t){return!1}},e.encoding=o,e.encodingFromData=function(t){return t instanceof Uint8Array&&(t=n(t)),o(t[0])};const s=Object.freeze(ri.names),a=Object.freeze(ri.codes);e.names=s,e.codes=a}),ii="undefined"!=typeof window?window:void 0!==_?_:"undefined"!=typeof self?self:{},oi=Object.prototype.toString,si=function(t){return t.replace(/^\s+|\s+$/g,"")},ai=Object.prototype.hasOwnProperty,ui=hi,ci=hi;function li(t,e,r){var n=t;return function(t){if(!t)return!1;var e=oi.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}(e)?(r=e,"string"==typeof t&&(n={uri:t})):n=function(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var n in r)ai.call(r,n)&&(t[n]=r[n])}return t}(e,{uri:t}),n.callback=r,n}function hi(t,e,r){return fi(e=li(t,e,r))}function fi(t){if(void 0===t.callback)throw new Error("callback argument missing");var e=!1,r=function(r,n,i){e||(e=!0,t.callback(r,n,i))};function n(){var t=void 0;if(t=u.response?u.response:u.responseText||function(t){try{if("document"===t.responseType)return t.responseXML;if(""===t.responseType&&(!t.responseXML||"parsererror"!==t.responseXML.documentElement.nodeName))return t.responseXML}catch(t){}return null}(u),y)try{t=JSON.parse(t)}catch(t){}return t}function i(t){return clearTimeout(c),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,r(t,g)}function o(){if(!a){var e;clearTimeout(c);var i=g,o=null;return 0!==(e=t.useXDR&&void 0===u.status?200:1223===u.status?204:u.status)?(i={body:n(),statusCode:e,method:h,headers:{},url:l,rawRequest:u},u.getAllResponseHeaders&&(i.headers=function(t){if(!t)return{};for(var e={},r=si(t).split("\n"),n=0;n<r.length;n++){var i=r[n],o=i.indexOf(":"),s=si(i.slice(0,o)).toLowerCase(),a=si(i.slice(o+1));void 0===e[s]?e[s]=a:"[object Array]"===Object.prototype.toString.call(e[s])?e[s].push(a):e[s]=[e[s],a]}return e}(u.getAllResponseHeaders()))):o=new Error("Internal XMLHttpRequest Error"),r(o,i,i.body)}}var s,a,u=t.xhr||null;u||(u=t.cors||t.useXDR?new hi.XDomainRequest:new hi.XMLHttpRequest);var c,l=u.url=t.uri||t.url,h=u.method=t.method||"GET",f=t.body||t.data,d=u.headers=t.headers||{},p=!!t.sync,y=!1,g={body:void 0,headers:{},statusCode:0,method:h,url:l,rawRequest:u};if("json"in t&&!1!==t.json&&(y=!0,d.accept||d.Accept||(d.Accept="application/json"),"GET"!==h&&"HEAD"!==h&&(d["content-type"]||d["Content-Type"]||(d["Content-Type"]="application/json"),f=JSON.stringify(!0===t.json?f:t.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(o,0)},u.onload=o,u.onerror=i,u.onprogress=function(){},u.onabort=function(){a=!0},u.ontimeout=i,u.open(h,l,!p,t.username,t.password),p||(u.withCredentials=!!t.withCredentials),!p&&t.timeout>0&&(c=setTimeout(function(){if(!a){a=!0,u.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",i(t)}},t.timeout)),u.setRequestHeader)for(s in d)d.hasOwnProperty(s)&&u.setRequestHeader(s,d[s]);else if(t.headers&&!function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(u.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(u),u.send(f||null),u}hi.XMLHttpRequest=ii.XMLHttpRequest||function(){},hi.XDomainRequest="withCredentials"in new hi.XMLHttpRequest?hi.XMLHttpRequest:ii.XDomainRequest,function(t,e){for(var r=0;r<t.length;r++)e(t[r])}(["get","put","post","patch","head","delete"],function(t){hi["delete"===t?"del":t]=function(e,r,n){return(r=li(e,r,n)).method=t.toUpperCase(),fi(r)}}),ui.default=ci;var di=function(t,{className:e,symbolName:r}){const n=Symbol.for(r),i={[e]:class extends t{constructor(...t){super(...t),Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return i[`is${e}`]=t=>!(!t||!t[n]),i};di.proto=function(t,{className:e,symbolName:r,withoutNew:n}){const i=Symbol.for(r),o={[e]:function(...e){if(n&&!(this instanceof o))return new o(...e);const r=t.call(this,...e)||this;return r&&!r[i]&&Object.defineProperty(r,i,{value:!0}),r}}[e];return o.prototype=Object.create(t.prototype),o.prototype.constructor=o,Object.defineProperty(o.prototype,Symbol.toStringTag,{get:()=>e}),o[`is${e}`]=t=>!(!t||!t[i]),o};var pi=function(t){if(t){if("function"==typeof t[Symbol.iterator])return t[Symbol.iterator]();if("function"==typeof t[Symbol.asyncIterator])return t[Symbol.asyncIterator]();if("function"==typeof t.next)return t}throw new Error("argument is not an iterator or iterable")},yi=class extends Error{constructor(t,e){super(t||"The operation was aborted"),this.type="aborted",this.code=e||"ABORT_ERR"}};const gi=(t,e,r)=>mi(t,Array.isArray(e)?e:[{signal:e,options:r}]),mi=(t,e)=>(t=pi(t),e=e.map(({signal:t,options:e})=>({signal:t,options:e||{}})),async function*(){let r;const n=()=>{r&&r()};for(const{signal:t}of e)t.addEventListener("abort",n);for(;;){let i;try{for(const{signal:t,options:r}of e)if(t.aborted){const{abortMessage:t,abortCode:e}=r;throw new yi(t,e)}const n=new Promise((t,n)=>{r=()=>{const{options:t}=e.find(({signal:t})=>t.aborted),{abortMessage:r,abortCode:i}=t;n(new yi(r,i))}});i=await Promise.race([n,t.next()]),r=null}catch(r){for(const{signal:t}of e)t.removeEventListener("abort",n);const i=e.find(({signal:t})=>t.aborted),o="aborted"===r.type&&i;if(o&&i.options.onAbort&&await i.options.onAbort(t),"function"==typeof t.return&&await t.return(),o&&i.options.returnOnAbort)return;throw r}if(i.done)break;yield i.value}for(const{signal:t}of e)t.removeEventListener("abort",n)}()),bi=(t,e,r)=>vi(t,Array.isArray(e)?e:[{signal:e,options:r}]),vi=(t,e)=>r=>t(mi(r,e));var wi=gi,_i=gi,Ei=bi,Si=bi;wi.AbortError=yi,wi.source=_i,wi.sink=Ei,wi.transform=Si,wi.duplex=(t,e,r)=>((t,e)=>({sink:vi(t.sink,e),source:mi(t.source,e)}))(t,Array.isArray(e)?e:[{signal:e,options:r}]);var Ti={CODE_P2P:421,CODE_CIRCUIT:290,CLOSE_TIMEOUT:2e3},Ri=t=>{if(t[Symbol.asyncIterator])return t;if(t.getReader)return async function*(){const e=t.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)return;yield r}}finally{e.releaseLock()}}();throw new Error("unknown stream")},Ai=t=>async e=>{e=pi(e);const r=t=>{"function"==typeof t.return&&t.return()};let n=null,i=null;const o=t=>{n=t,i&&i(t),r(e)};let s=null,a=!1;const u=()=>{a=!0,s&&s()};let c=null,l=!1;const h=()=>{l=!0,c&&c()};let f=null;const d=()=>{f&&f()};t.once("error",o),t.once("close",u),t.once("finish",h);try{for await(const r of e){if(!t.writable||t.destroyed||n)break;!1===t.write(r)&&await new Promise((e,r)=>{s=f=e,i=r,t.once("drain",d)})}}catch(e){n||t.destroy(),n=e}try{if(t.writable&&t.end(),await(r(e),new Promise((t,e)=>{if(a||l||n)return t();c=s=t,i=e})),n)throw n}finally{t.removeListener("error",o),t.removeListener("close",u),t.removeListener("finish",h),t.removeListener("drain",d)}},Ci=t=>({sink:Ai(t),source:Ri(t)}),ki=Ri,Ii=Ai,Oi=Ci;ki.source=Ri,ki.sink=Ii,ki.transform=t=>async function*(e){const r=Ci(t);r.sink(e).catch(t=>{}),yield*r.source},ki.duplex=Oi;var Mi=E(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isCorrect=e.isInSubnet=void 0,e.isInSubnet=function(t){return!(this.subnetMask<t.subnetMask)&&this.mask(t.subnetMask)===t.mask()},e.isCorrect=function(t){return function(){return this.addressMinusSuffix===this.correctForm()&&(this.subnetMask===t&&!this.parsedSubnet||this.parsedSubnet===String(this.subnetMask))}}}),Bi=E(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.RE_SUBNET_STRING=e.RE_ADDRESS=e.GROUPS=e.BITS=void 0,e.BITS=32,e.GROUPS=4,e.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g,e.RE_SUBNET_STRING=/\/\d{1,2}$/}),xi=E(function(t,e){var r,n=_&&_.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.AddressError=void 0;var i=function(t){function e(e,r){var n=t.call(this,e)||this;return n.name="AddressError",null!==r&&(n.parseMessage=r),n}return n(e,t),e}(Error);e.AddressError=i}),Ni=E(function(t,e){(function(){var e;function r(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):this.fromString(t,null==e&&"string"!=typeof t?256:e))}function n(){return new r(null)}var i="undefined"!=typeof navigator;i&&"Microsoft Internet Explorer"==navigator.appName?(r.prototype.am=function(t,e,r,n,i,o){for(var s=32767&e,a=e>>15;--o>=0;){var u=32767&this[t],c=this[t++]>>15,l=a*u+c*s;i=((u=s*u+((32767&l)<<15)+r[n]+(1073741823&i))>>>30)+(l>>>15)+a*c+(i>>>30),r[n++]=1073741823&u}return i},e=30):i&&"Netscape"!=navigator.appName?(r.prototype.am=function(t,e,r,n,i,o){for(;--o>=0;){var s=e*this[t++]+r[n]+i;i=Math.floor(s/67108864),r[n++]=67108863&s}return i},e=26):(r.prototype.am=function(t,e,r,n,i,o){for(var s=16383&e,a=e>>14;--o>=0;){var u=16383&this[t],c=this[t++]>>14,l=a*u+c*s;i=((u=s*u+((16383&l)<<14)+r[n]+i)>>28)+(l>>14)+a*c,r[n++]=268435455&u}return i},e=28),r.prototype.DB=e,r.prototype.DM=(1<<e)-1,r.prototype.DV=1<<e,r.prototype.FV=Math.pow(2,52),r.prototype.F1=52-e,r.prototype.F2=2*e-52;var o,s,a=new Array;for(o="0".charCodeAt(0),s=0;s<=9;++s)a[o++]=s;for(o="a".charCodeAt(0),s=10;s<36;++s)a[o++]=s;for(o="A".charCodeAt(0),s=10;s<36;++s)a[o++]=s;function u(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function c(t,e){var r=a[t.charCodeAt(e)];return null==r?-1:r}function l(t){var e=n();return e.fromInt(t),e}function h(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function f(t){this.m=t}function d(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function p(t,e){return t&e}function y(t,e){return t|e}function g(t,e){return t^e}function m(t,e){return t&~e}function b(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function v(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function w(){}function _(t){return t}function E(t){this.r2=n(),this.q3=n(),r.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}f.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},f.prototype.revert=function(t){return t},f.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},f.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},f.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},d.prototype.convert=function(t){var e=n();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(r.ZERO)>0&&this.m.subTo(e,e),e},d.prototype.revert=function(t){var e=n();return t.copyTo(e),this.reduce(e),e},d.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},d.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},d.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},r.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},r.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},r.prototype.fromString=function(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var i=t.length,o=!1,s=0;--i>=0;){var a=8==n?255&t[i]:c(t,i);a<0?"-"==t.charAt(i)&&(o=!0):(o=!1,0==s?this[this.t++]=a:s+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&r.ZERO.subTo(this,this)},r.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},r.prototype.dlShiftTo=function(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s},r.prototype.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},r.prototype.lShiftTo=function(t,e){var r,n=t%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(t/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)e[r+s+1]=this[r]>>i|a,a=(this[r]&o)<<n;for(r=s-1;r>=0;--r)e[r]=0;e[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()},r.prototype.rShiftTo=function(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)e[s-r-1]|=(this[s]&o)<<i,e[s-r]=this[s]>>n;n>0&&(e[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}},r.prototype.subTo=function(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[r++]=this.DV+n:n>0&&(e[r++]=n),e.t=r,e.clamp()},r.prototype.multiplyTo=function(t,e){var n=this.abs(),i=t.abs(),o=n.t;for(e.t=o+i.t;--o>=0;)e[o]=0;for(o=0;o<i.t;++o)e[o+n.t]=n.am(0,i[o],e,o,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&r.ZERO.subTo(e,e)},r.prototype.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},r.prototype.divRemTo=function(t,e,i){var o=t.abs();if(!(o.t<=0)){var s=this.abs();if(s.t<o.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=n());var a=n(),u=this.s,c=t.s,l=this.DB-h(o[o.t-1]);l>0?(o.lShiftTo(l,a),s.lShiftTo(l,i)):(o.copyTo(a),s.copyTo(i));var f=a.t,d=a[f-1];if(0!=d){var p=d*(1<<this.F1)+(f>1?a[f-2]>>this.F2:0),y=this.FV/p,g=(1<<this.F1)/p,m=1<<this.F2,b=i.t,v=b-f,w=null==e?n():e;for(a.dlShiftTo(v,w),i.compareTo(w)>=0&&(i[i.t++]=1,i.subTo(w,i)),r.ONE.dlShiftTo(f,w),w.subTo(a,a);a.t<f;)a[a.t++]=0;for(;--v>=0;){var _=i[--b]==d?this.DM:Math.floor(i[b]*y+(i[b-1]+m)*g);if((i[b]+=a.am(0,_,i,v,0,f))<_)for(a.dlShiftTo(v,w),i.subTo(w,i);i[b]<--_;)i.subTo(w,i)}null!=e&&(i.drShiftTo(f,e),u!=c&&r.ZERO.subTo(e,e)),i.t=f,i.clamp(),l>0&&i.rShiftTo(l,i),u<0&&r.ZERO.subTo(i,i)}}},r.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},r.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},r.prototype.exp=function(t,e){if(t>4294967295||t<1)return r.ONE;var i=n(),o=n(),s=e.convert(this),a=h(t)-1;for(s.copyTo(i);--a>=0;)if(e.sqrTo(i,o),(t&1<<a)>0)e.mulTo(o,s,i);else{var u=i;i=o,o=u}return e.revert(i)},r.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(i=!0,o=u(r));s>=0;)a<e?(r=(this[s]&(1<<a)-1)<<e-a,r|=this[--s]>>(a+=this.DB-e)):(r=this[s]>>(a-=e)&n,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=u(r));return i?o:"0"},r.prototype.negate=function(){var t=n();return r.ZERO.subTo(this,t),t},r.prototype.abs=function(){return this.s<0?this.negate():this},r.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0},r.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+h(this[this.t-1]^this.s&this.DM)},r.prototype.mod=function(t){var e=n();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(r.ZERO)>0&&t.subTo(e,e),e},r.prototype.modPowInt=function(t,e){var r;return r=t<256||e.isEven()?new f(e):new d(e),this.exp(t,r)},r.ZERO=l(0),r.ONE=l(1),w.prototype.convert=_,w.prototype.revert=_,w.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r)},w.prototype.sqrTo=function(t,e){t.squareTo(e)},E.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=n();return t.copyTo(e),this.reduce(e),e},E.prototype.revert=function(t){return t},E.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},E.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},E.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var S,T,R,A=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],C=(1<<26)/A[A.length-1];function k(){var t;t=(new Date).getTime(),T[R++]^=255&t,T[R++]^=t>>8&255,T[R++]^=t>>16&255,T[R++]^=t>>24&255,R>=L&&(R-=L)}if(r.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},r.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=l(r),o=n(),s=n(),a="";for(this.divRemTo(i,o,s);o.signum()>0;)a=(r+s.intValue()).toString(t).substr(1)+a,o.divRemTo(i,o,s);return s.intValue().toString(t)+a},r.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),i=Math.pow(e,n),o=!1,s=0,a=0,u=0;u<t.length;++u){var l=c(t,u);l<0?"-"==t.charAt(u)&&0==this.signum()&&(o=!0):(a=e*a+l,++s>=n&&(this.dMultiply(i),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),o&&r.ZERO.subTo(this,this)},r.prototype.fromNumber=function(t,e,n){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(r.ONE.shiftLeft(t-1),y,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(r.ONE.shiftLeft(t-1),this);else{var i=new Array,o=7&t;i.length=1+(t>>3),e.nextBytes(i),o>0?i[0]&=(1<<o)-1:i[0]=0,this.fromString(i,256)}},r.prototype.bitwiseTo=function(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r[n]=e(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r[n]=e(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r[n]=e(i,t[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()},r.prototype.changeBit=function(t,e){var n=r.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n},r.prototype.addTo=function(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]+t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t[r],e[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[r++]=n:n<-1&&(e[r++]=this.DV+n),e.t=r,e.clamp()},r.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},r.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},r.prototype.multiplyLowerTo=function(t,e,r){var n,i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,t[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t[i],r,i,0,e-i);r.clamp()},r.prototype.multiplyUpperTo=function(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r[this.t+n-e]=this.am(e-n,t[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)},r.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this[n])%t;return r},r.prototype.millerRabin=function(t){var e=this.subtract(r.ONE),i=e.getLowestSetBit();if(i<=0)return!1;var o=e.shiftRight(i);(t=t+1>>1)>A.length&&(t=A.length);for(var s=n(),a=0;a<t;++a){s.fromInt(A[Math.floor(Math.random()*A.length)]);var u=s.modPow(o,this);if(0!=u.compareTo(r.ONE)&&0!=u.compareTo(e)){for(var c=1;c++<i&&0!=u.compareTo(e);)if(0==(u=u.modPowInt(2,this)).compareTo(r.ONE))return!1;if(0!=u.compareTo(e))return!1}}return!0},r.prototype.clone=function(){var t=n();return this.copyTo(t),t},r.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},r.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},r.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},r.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},r.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var r,n=this.DB-t*this.DB%8,i=0;if(t-- >0)for(n<this.DB&&(r=this[t]>>n)!=(this.s&this.DM)>>n&&(e[i++]=r|this.s<<this.DB-n);t>=0;)n<8?(r=(this[t]&(1<<n)-1)<<8-n,r|=this[--t]>>(n+=this.DB-8)):(r=this[t]>>(n-=8)&255,n<=0&&(n+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(e[i++]=r);return e},r.prototype.equals=function(t){return 0==this.compareTo(t)},r.prototype.min=function(t){return this.compareTo(t)<0?this:t},r.prototype.max=function(t){return this.compareTo(t)>0?this:t},r.prototype.and=function(t){var e=n();return this.bitwiseTo(t,p,e),e},r.prototype.or=function(t){var e=n();return this.bitwiseTo(t,y,e),e},r.prototype.xor=function(t){var e=n();return this.bitwiseTo(t,g,e),e},r.prototype.andNot=function(t){var e=n();return this.bitwiseTo(t,m,e),e},r.prototype.not=function(){for(var t=n(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},r.prototype.shiftLeft=function(t){var e=n();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},r.prototype.shiftRight=function(t){var e=n();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},r.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+b(this[t]);return this.s<0?this.t*this.DB:-1},r.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=v(this[r]^e);return t},r.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},r.prototype.setBit=function(t){return this.changeBit(t,y)},r.prototype.clearBit=function(t){return this.changeBit(t,m)},r.prototype.flipBit=function(t){return this.changeBit(t,g)},r.prototype.add=function(t){var e=n();return this.addTo(t,e),e},r.prototype.subtract=function(t){var e=n();return this.subTo(t,e),e},r.prototype.multiply=function(t){var e=n();return this.multiplyTo(t,e),e},r.prototype.divide=function(t){var e=n();return this.divRemTo(t,e,null),e},r.prototype.remainder=function(t){var e=n();return this.divRemTo(t,null,e),e},r.prototype.divideAndRemainder=function(t){var e=n(),r=n();return this.divRemTo(t,e,r),new Array(e,r)},r.prototype.modPow=function(t,e){var r,i,o=t.bitLength(),s=l(1);if(o<=0)return s;r=o<18?1:o<48?3:o<144?4:o<768?5:6,i=o<8?new f(e):e.isEven()?new E(e):new d(e);var a=new Array,u=3,c=r-1,p=(1<<r)-1;if(a[1]=i.convert(this),r>1){var y=n();for(i.sqrTo(a[1],y);u<=p;)a[u]=n(),i.mulTo(y,a[u-2],a[u]),u+=2}var g,m,b=t.t-1,v=!0,w=n();for(o=h(t[b])-1;b>=0;){for(o>=c?g=t[b]>>o-c&p:(g=(t[b]&(1<<o+1)-1)<<c-o,b>0&&(g|=t[b-1]>>this.DB+o-c)),u=r;0==(1&g);)g>>=1,--u;if((o-=u)<0&&(o+=this.DB,--b),v)a[g].copyTo(s),v=!1;else{for(;u>1;)i.sqrTo(s,w),i.sqrTo(w,s),u-=2;u>0?i.sqrTo(s,w):(m=s,s=w,w=m),i.mulTo(w,a[g],s)}for(;b>=0&&0==(t[b]&1<<o);)i.sqrTo(s,w),m=s,s=w,w=m,--o<0&&(o=this.DB-1,--b)}return i.revert(s)},r.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return r.ZERO;for(var n=t.clone(),i=this.clone(),o=l(1),s=l(0),a=l(0),u=l(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?(a.isEven()&&u.isEven()||(a.addTo(this,a),u.subTo(t,u)),a.rShiftTo(1,a)):u.isEven()||u.subTo(t,u),u.rShiftTo(1,u);n.compareTo(i)>=0?(n.subTo(i,n),e&&o.subTo(a,o),s.subTo(u,s)):(i.subTo(n,i),e&&a.subTo(o,a),u.subTo(s,u))}return 0!=i.compareTo(r.ONE)?r.ZERO:u.compareTo(t)>=0?u.subtract(t):u.signum()<0?(u.addTo(t,u),u.signum()<0?u.add(t):u):u},r.prototype.pow=function(t){return this.exp(t,new w)},r.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},r.prototype.isProbablePrime=function(t){var e,r=this.abs();if(1==r.t&&r[0]<=A[A.length-1]){for(e=0;e<A.length;++e)if(r[0]==A[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<A.length;){for(var n=A[e],i=e+1;i<A.length&&n<C;)n*=A[i++];for(n=r.modInt(n);e<i;)if(n%A[e++]==0)return!1}return r.millerRabin(t)},r.prototype.square=function(){var t=n();return this.squareTo(t),t},r.prototype.Barrett=E,null==T){var I;if(T=new Array,R=0,"undefined"!=typeof window&&window.crypto)if(window.crypto.getRandomValues){var O=new Uint8Array(32);for(window.crypto.getRandomValues(O),I=0;I<32;++I)T[R++]=O[I]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var M=window.crypto.random(32);for(I=0;I<M.length;++I)T[R++]=255&M.charCodeAt(I)}for(;R<L;)I=Math.floor(65536*Math.random()),T[R++]=I>>>8,T[R++]=255&I;R=0,k()}function B(){if(null==S){for(k(),(S=new N).init(T),R=0;R<T.length;++R)T[R]=0;R=0}return S.next()}function x(){}function N(){this.i=0,this.j=0,this.S=new Array}x.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=B()},N.prototype.init=function(t){var e,r,n;for(e=0;e<256;++e)this.S[e]=e;for(r=0,e=0;e<256;++e)n=this.S[e],this.S[e]=this.S[r=r+this.S[e]+t[e%t.length]&255],this.S[r]=n;this.i=0,this.j=0},N.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var L=256;t.exports={default:r,BigInteger:r,SecureRandom:x}}).call(_)}),Li=E(function(t,e){!function(){var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function r(t){return i(s(t),arguments)}function n(t,e){return r.apply(null,[t].concat(e||[]))}function i(e,n){var i,o,s,a,u,c,l,h,f,d=1,p=e.length,y="";for(o=0;o<p;o++)if("string"==typeof e[o])y+=e[o];else if("object"==typeof e[o]){if((a=e[o]).keys)for(i=n[d],s=0;s<a.keys.length;s++){if(null==i)throw new Error(r('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[s],a.keys[s-1]));i=i[a.keys[s]]}else i=a.param_no?n[a.param_no]:n[d++];if(t.not_type.test(a.type)&&t.not_primitive.test(a.type)&&i instanceof Function&&(i=i()),t.numeric_arg.test(a.type)&&"number"!=typeof i&&isNaN(i))throw new TypeError(r("[sprintf] expecting number but found %T",i));switch(t.number.test(a.type)&&(h=i>=0),a.type){case"b":i=parseInt(i,10).toString(2);break;case"c":i=String.fromCharCode(parseInt(i,10));break;case"d":case"i":i=parseInt(i,10);break;case"j":i=JSON.stringify(i,null,a.width?parseInt(a.width):0);break;case"e":i=a.precision?parseFloat(i).toExponential(a.precision):parseFloat(i).toExponential();break;case"f":i=a.precision?parseFloat(i).toFixed(a.precision):parseFloat(i);break;case"g":i=a.precision?String(Number(i.toPrecision(a.precision))):parseFloat(i);break;case"o":i=(parseInt(i,10)>>>0).toString(8);break;case"s":i=String(i),i=a.precision?i.substring(0,a.precision):i;break;case"t":i=String(!!i),i=a.precision?i.substring(0,a.precision):i;break;case"T":i=Object.prototype.toString.call(i).slice(8,-1).toLowerCase(),i=a.precision?i.substring(0,a.precision):i;break;case"u":i=parseInt(i,10)>>>0;break;case"v":i=i.valueOf(),i=a.precision?i.substring(0,a.precision):i;break;case"x":i=(parseInt(i,10)>>>0).toString(16);break;case"X":i=(parseInt(i,10)>>>0).toString(16).toUpperCase()}t.json.test(a.type)?y+=i:(!t.number.test(a.type)||h&&!a.sign?f="":(f=h?"+":"-",i=i.toString().replace(t.sign,"")),c=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",l=a.width-(f+i).length,u=a.width&&l>0?c.repeat(l):"",y+=a.align?f+i+u:"0"===c?f+u+i:u+f+i)}return y}var o=Object.create(null);function s(e){if(o[e])return o[e];for(var r,n=e,i=[],s=0;n;){if(null!==(r=t.text.exec(n)))i.push(r[0]);else if(null!==(r=t.modulo.exec(n)))i.push("%");else{if(null===(r=t.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(r[2]){s|=1;var a=[],u=r[2],c=[];if(null===(c=t.key.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(c[1]);""!==(u=u.substring(c[0].length));)if(null!==(c=t.key_access.exec(u)))a.push(c[1]);else{if(null===(c=t.index_access.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(c[1])}r[2]=a}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i.push({placeholder:r[0],param_no:r[1],keys:r[2],sign:r[3],pad_char:r[4],align:r[5],width:r[6],precision:r[7],type:r[8]})}n=n.substring(r[0].length)}return o[e]=i}e.sprintf=r,e.vsprintf=n,"undefined"!=typeof window&&(window.sprintf=r,window.vsprintf=n)}()}),Di=E(function(t,e){var r=_&&_.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=_&&_.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=_&&_.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Address4=void 0;var o=i(Mi),s=i(Bi),a=function(){function t(t){this.groups=s.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=o.isCorrect(s.BITS),this.isInSubnet=o.isInSubnet,this.address=t;var e=s.RE_SUBNET_STRING.exec(t);if(e){if(this.parsedSubnet=e[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>s.BITS)throw new xi.AddressError("Invalid subnet mask.");t=t.replace(s.RE_SUBNET_STRING,"")}this.addressMinusSuffix=t,this.parsedAddress=this.parse(t)}return t.isValid=function(e){try{return new t(e),!0}catch(t){return!1}},t.prototype.parse=function(t){var e=t.split(".");if(!t.match(s.RE_ADDRESS))throw new xi.AddressError("Invalid IPv4 address.");return e},t.prototype.correctForm=function(){return this.parsedAddress.map(function(t){return parseInt(t,10)}).join(".")},t.fromHex=function(e){var r,n=e.replace(/:/g,"").padStart(8,"0"),i=[];for(r=0;r<8;r+=2){var o=n.slice(r,r+2);i.push(parseInt(o,16))}return new t(i.join("."))},t.fromInteger=function(e){return t.fromHex(e.toString(16))},t.prototype.toHex=function(){return this.parsedAddress.map(function(t){return Li.sprintf("%02x",parseInt(t,10))}).join(":")},t.prototype.toArray=function(){return this.parsedAddress.map(function(t){return parseInt(t,10)})},t.prototype.toGroup6=function(){var t,e=[];for(t=0;t<s.GROUPS;t+=2){var r=Li.sprintf("%02x%02x",parseInt(this.parsedAddress[t],10),parseInt(this.parsedAddress[t+1],10));e.push(Li.sprintf("%x",parseInt(r,16)))}return e.join(":")},t.prototype.bigInteger=function(){return new Ni.BigInteger(this.parsedAddress.map(function(t){return Li.sprintf("%02x",parseInt(t,10))}).join(""),16)},t.prototype._startAddress=function(){return new Ni.BigInteger(this.mask()+"0".repeat(s.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new Ni.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new Ni.BigInteger(this.mask()+"1".repeat(s.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new Ni.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.fromBigInteger=function(e){return t.fromInteger(parseInt(e.toString(),10))},t.prototype.mask=function(t){return void 0===t&&(t=this.subnetMask),this.getBitsBase2(0,t)},t.prototype.getBitsBase2=function(t,e){return this.binaryZeroPad().slice(t,e)},t.prototype.isMulticast=function(){return this.isInSubnet(new t("224.0.0.0/4"))},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(s.BITS,"0")},t.prototype.groupForV6=function(){var t=this.parsedAddress;return this.address.replace(s.RE_ADDRESS,Li.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',t.slice(0,2).join("."),t.slice(2,4).join(".")))},t}();e.Address4=a}),Pi=E(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.RE_URL_WITH_PORT=e.RE_URL=e.RE_ZONE_STRING=e.RE_SUBNET_STRING=e.RE_BAD_ADDRESS=e.RE_BAD_CHARACTERS=e.TYPES=e.SCOPES=e.GROUPS=e.BITS=void 0,e.BITS=128,e.GROUPS=8,e.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"},e.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"},e.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi,e.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi,e.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/,e.RE_ZONE_STRING=/%.*$/,e.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/),e.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)}),ji=E(function(t,e){function r(t){return t.replace(/(0+)/g,'<span class="zero">$1</span>')}function n(t){return t.replace(/^(0+)/,'<span class="zero">$1</span>')}Object.defineProperty(e,"__esModule",{value:!0}),e.simpleGroup=e.spanLeadingZeroes=e.spanAll=e.spanAllZeroes=void 0,e.spanAllZeroes=r,e.spanAll=function(t,e){return void 0===e&&(e=0),t.split("").map(function(t,n){return Li.sprintf('<span class="digit value-%s position-%d">%s</span>',t,n+e,r(t))}).join("")},e.spanLeadingZeroes=function(t){return t.split(":").map(function(t){return n(t)}).join(":")},e.simpleGroup=function(t,e){return void 0===e&&(e=0),t.split(":").map(function(t,r){return/group-v4/.test(t)?t:Li.sprintf('<span class="hover-group group-%d">%s</span>',r+e,n(t))})}}),Fi=E(function(t,e){var r=_&&_.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=_&&_.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=_&&_.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.possibleElisions=e.simpleRegularExpression=e.ADDRESS_BOUNDARY=e.padGroup=e.groupPossibilities=void 0;var o=i(Pi);function s(t){return Li.sprintf("(%s)",t.join("|"))}function a(t){return t.length<4?Li.sprintf("0{0,%d}%s",4-t.length,t):t}e.groupPossibilities=s,e.padGroup=a,e.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]",e.simpleRegularExpression=function(t){var e=[];t.forEach(function(t,r){0===parseInt(t,16)&&e.push(r)});var r=e.map(function(e){return t.map(function(t,r){if(r===e){var n=0===r||r===o.GROUPS-1?":":"";return s([a(t),n])}return a(t)}).join(":")});return r.push(t.map(a).join(":")),s(r)},e.possibleElisions=function(t,e,r){var n=e?"":":",i=r?"":":",o=[];e||r||o.push("::"),e&&r&&o.push(""),(r&&!e||!r&&e)&&o.push(":"),o.push(Li.sprintf("%s(:0{1,4}){1,%d}",n,t-1)),o.push(Li.sprintf("(0{1,4}:){1,%d}%s",t-1,i)),o.push(Li.sprintf("(0{1,4}:){%d}0{1,4}",t-1));for(var a=1;a<t-1;a++)for(var u=1;u<t-a;u++)o.push(Li.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",u,t-u-a-1));return s(o)}}),Ui=E(function(t,e){var r=_&&_.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=_&&_.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=_&&_.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e},o=_&&_.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n};Object.defineProperty(e,"__esModule",{value:!0}),e.Address6=void 0;var s=i(Mi),a=i(Bi),u=i(Pi),c=i(ji);function l(t){if(!t)throw new Error("Assertion failed.")}function h(t){return(t=t.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2')).replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2')}function f(t){return Li.sprintf("%04x",parseInt(t,16))}function d(t){return 255&t}var p=function(){function t(t,e){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=s.isInSubnet,this.isCorrect=s.isCorrect(u.BITS),this.groups=void 0===e?u.GROUPS:e,this.address=t;var r=u.RE_SUBNET_STRING.exec(t);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>u.BITS)throw new xi.AddressError("Invalid subnet mask.");t=t.replace(u.RE_SUBNET_STRING,"")}else if(/\//.test(t))throw new xi.AddressError("Invalid subnet mask.");var n=u.RE_ZONE_STRING.exec(t);n&&(this.zone=n[0],t=t.replace(u.RE_ZONE_STRING,"")),this.addressMinusSuffix=t,this.parsedAddress=this.parse(this.addressMinusSuffix)}return t.isValid=function(e){try{return new t(e),!0}catch(t){return!1}},t.fromBigInteger=function(e){var r,n=e.toString(16).padStart(32,"0"),i=[];for(r=0;r<u.GROUPS;r++)i.push(n.slice(4*r,4*(r+1)));return new t(i.join(":"))},t.fromURL=function(e){var r,n,i=null;if(-1!==e.indexOf("[")&&-1!==e.indexOf("]:")){if(null===(n=u.RE_URL_WITH_PORT.exec(e)))return{error:"failed to parse address with port",address:null,port:null};r=n[1],i=n[2]}else if(-1!==e.indexOf("/")){if(e=e.replace(/^[a-z0-9]+:\/\//,""),null===(n=u.RE_URL.exec(e)))return{error:"failed to parse address from URL",address:null,port:null};r=n[1]}else r=e;return i?((i=parseInt(i,10))<0||i>65536)&&(i=null):i=null,{address:new t(r),port:i}},t.fromAddress4=function(e){var r=new Di.Address4(e),n=u.BITS-(a.BITS-r.subnetMask);return new t("::ffff:"+r.correctForm()+"/"+n)},t.fromArpa=function(e){var r=e.replace(/(\.ip6\.arpa)?\.$/,"");if(63!==r.length)throw new xi.AddressError("Invalid 'ip6.arpa' form.");for(var n=r.split(".").reverse(),i=7;i>0;i--)n.splice(4*i,0,":");return new t(r=n.join(""))},t.prototype.microsoftTranscription=function(){return Li.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},t.prototype.mask=function(t){return void 0===t&&(t=this.subnetMask),this.getBitsBase2(0,t)},t.prototype.possibleSubnets=function(t){void 0===t&&(t=128);var e=u.BITS-this.subnetMask-Math.abs(t-u.BITS);return e<0?"0":function(t){for(var e=/(\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}(new Ni.BigInteger("2",10).pow(e).toString(10))},t.prototype._startAddress=function(){return new Ni.BigInteger(this.mask()+"0".repeat(u.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new Ni.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new Ni.BigInteger(this.mask()+"1".repeat(u.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new Ni.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.prototype.getScope=function(){var t=u.SCOPES[this.getBits(12,16).intValue()];return"Global unicast"===this.getType()&&"Link local"!==t&&(t="Global"),t||"Unknown"},t.prototype.getType=function(){for(var e=0,r=Object.keys(u.TYPES);e<r.length;e++){var n=r[e];if(this.isInSubnet(new t(n)))return u.TYPES[n]}return"Global unicast"},t.prototype.getBits=function(t,e){return new Ni.BigInteger(this.getBitsBase2(t,e),2)},t.prototype.getBitsBase2=function(t,e){return this.binaryZeroPad().slice(t,e)},t.prototype.getBitsBase16=function(t,e){var r=e-t;if(r%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(t,e).toString(16).padStart(r/4,"0")},t.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,u.BITS)},t.prototype.reverseForm=function(t){t||(t={});var e=Math.floor(this.subnetMask/4),r=this.canonicalForm().replace(/:/g,"").split("").slice(0,e).reverse().join(".");return e>0?t.omitSuffix?r:Li.sprintf("%s.ip6.arpa.",r):t.omitSuffix?"":"ip6.arpa."},t.prototype.correctForm=function(){var t,e=[],r=0,n=[];for(t=0;t<this.parsedAddress.length;t++){var i=parseInt(this.parsedAddress[t],16);0===i&&r++,0!==i&&r>0&&(r>1&&n.push([t-r,t-1]),r=0)}r>1&&n.push([this.parsedAddress.length-r,this.parsedAddress.length-1]);var o=n.map(function(t){return t[1]-t[0]+1});if(n.length>0){var s=o.indexOf(Math.max.apply(Math,o));e=function(t,e){var r,n=[],i=[];for(r=0;r<t.length;r++)r<e[0]?n.push(t[r]):r>e[1]&&i.push(t[r]);return n.concat(["compact"]).concat(i)}(this.parsedAddress,n[s])}else e=this.parsedAddress;for(t=0;t<e.length;t++)"compact"!==e[t]&&(e[t]=parseInt(e[t],16).toString(16));var a=e.join(":");return(a=(a=a.replace(/^compact$/,"::")).replace(/^compact|compact$/,":")).replace(/compact/,"")},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(u.BITS,"0")},t.prototype.parse4in6=function(t){var e=t.split(":"),r=e.slice(-1)[0].match(a.RE_ADDRESS);if(r){this.parsedAddress4=r[0],this.address4=new Di.Address4(this.parsedAddress4);for(var n=0;n<this.address4.groups;n++)if(/^0[0-9]+/.test(this.address4.parsedAddress[n]))throw new xi.AddressError("IPv4 addresses can't have leading zeroes.",t.replace(a.RE_ADDRESS,this.address4.parsedAddress.map(h).join(".")));this.v4=!0,e[e.length-1]=this.address4.toGroup6(),t=e.join(":")}return t},t.prototype.parse=function(t){var e=(t=this.parse4in6(t)).match(u.RE_BAD_CHARACTERS);if(e)throw new xi.AddressError(Li.sprintf("Bad character%s detected in address: %s",e.length>1?"s":"",e.join("")),t.replace(u.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var r=t.match(u.RE_BAD_ADDRESS);if(r)throw new xi.AddressError(Li.sprintf("Address failed regex: %s",r.join("")),t.replace(u.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],i=t.split("::");if(2===i.length){var o=i[0].split(":"),s=i[1].split(":");1===o.length&&""===o[0]&&(o=[]),1===s.length&&""===s[0]&&(s=[]);var a=this.groups-(o.length+s.length);if(!a)throw new xi.AddressError("Error parsing groups");this.elidedGroups=a,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,n=n.concat(o);for(var c=0;c<a;c++)n.push("0");n=n.concat(s)}else{if(1!==i.length)throw new xi.AddressError("Too many :: groups found");n=t.split(":"),this.elidedGroups=0}if((n=n.map(function(t){return Li.sprintf("%x",parseInt(t,16))})).length!==this.groups)throw new xi.AddressError("Incorrect number of groups found");return n},t.prototype.canonicalForm=function(){return this.parsedAddress.map(f).join(":")},t.prototype.decimal=function(){return this.parsedAddress.map(function(t){return Li.sprintf("%05d",parseInt(t,16))}).join(":")},t.prototype.bigInteger=function(){return new Ni.BigInteger(this.parsedAddress.map(f).join(""),16)},t.prototype.to4=function(){var t=this.binaryZeroPad().split("");return Di.Address4.fromHex(new Ni.BigInteger(t.slice(96,128).join(""),2).toString(16))},t.prototype.to4in6=function(){var e=this.to4(),r=new t(this.parsedAddress.slice(0,6).join(":"),6).correctForm(),n="";return/:$/.test(r)||(n=":"),r+n+e.address},t.prototype.inspectTeredo=function(){var t=this.getBitsBase16(0,32),e=this.getBits(80,96).xor(new Ni.BigInteger("ffff",16)).toString(),r=Di.Address4.fromHex(this.getBitsBase16(32,64)),n=Di.Address4.fromHex(this.getBits(96,128).xor(new Ni.BigInteger("ffffffff",16)).toString(16)),i=this.getBits(64,80),o=this.getBitsBase2(64,80),s=i.testBit(15),a=i.testBit(14),u=i.testBit(8),c=i.testBit(9),l=new Ni.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:Li.sprintf("%s:%s",t.slice(0,4),t.slice(4,8)),server4:r.address,client4:n.address,flags:o,coneNat:s,microsoft:{reserved:a,universalLocal:c,groupIndividual:u,nonce:l},udpPort:e}},t.prototype.inspect6to4=function(){var t=this.getBitsBase16(0,16),e=Di.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Li.sprintf("%s",t.slice(0,4)),gateway:e.address}},t.prototype.to6to4=function(){return this.is4()?new t(["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":")):null},t.prototype.toByteArray=function(){var t=this.bigInteger().toByteArray();return 17===t.length&&0===t[0]?t.slice(1):t},t.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(d)},t.fromByteArray=function(t){return this.fromUnsignedByteArray(t.map(d))},t.fromUnsignedByteArray=function(e){for(var r=new Ni.BigInteger("256",10),n=new Ni.BigInteger("0",10),i=new Ni.BigInteger("1",10),o=e.length-1;o>=0;o--)n=n.add(i.multiply(new Ni.BigInteger(e[o].toString(10),10))),i=i.multiply(r);return t.fromBigInteger(n)},t.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},t.prototype.isLinkLocal=function(){return"1111111010000000000000000000000000000000000000000000000000000000"===this.getBitsBase2(0,64)},t.prototype.isMulticast=function(){return"Multicast"===this.getType()},t.prototype.is4=function(){return this.v4},t.prototype.isTeredo=function(){return this.isInSubnet(new t("2001::/32"))},t.prototype.is6to4=function(){return this.isInSubnet(new t("2002::/16"))},t.prototype.isLoopback=function(){return"Loopback"===this.getType()},t.prototype.href=function(t){return t=void 0===t?"":Li.sprintf(":%s",t),Li.sprintf("http://[%s]%s/",this.correctForm(),t)},t.prototype.link=function(t){t||(t={}),void 0===t.className&&(t.className=""),void 0===t.prefix&&(t.prefix="/#address="),void 0===t.v4&&(t.v4=!1);var e=this.correctForm;return t.v4&&(e=this.to4in6),t.className?Li.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',t.prefix,e.call(this),t.className):Li.sprintf('<a href="%1$s%2$s">%2$s</a>',t.prefix,e.call(this))},t.prototype.group=function(){if(0===this.elidedGroups)return c.simpleGroup(this.address).join(":");l("number"==typeof this.elidedGroups),l("number"==typeof this.elisionBegin);var t=[],e=this.address.split("::"),r=e[0],n=e[1];r.length?t.push.apply(t,c.simpleGroup(r)):t.push("");for(var i=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)i.push(Li.sprintf("group-%d",o));return t.push(Li.sprintf('<span class="%s"></span>',i.join(" "))),n.length?t.push.apply(t,c.simpleGroup(n,this.elisionEnd)):t.push(""),this.is4()&&(l(this.address4 instanceof Di.Address4),t.pop(),t.push(this.address4.groupForV6())),t.join(":")},t.prototype.regularExpressionString=function(e){void 0===e&&(e=!1);var r=[],n=new t(this.correctForm());if(0===n.elidedGroups)r.push(Fi.simpleRegularExpression(n.parsedAddress));else if(n.elidedGroups===u.GROUPS)r.push(Fi.possibleElisions(u.GROUPS));else{var i=n.address.split("::");i[0].length&&r.push(Fi.simpleRegularExpression(i[0].split(":"))),l("number"==typeof n.elidedGroups),r.push(Fi.possibleElisions(n.elidedGroups,0!==i[0].length,0!==i[1].length)),i[1].length&&r.push(Fi.simpleRegularExpression(i[1].split(":"))),r=[r.join(":")]}return e||(r=o(["(?=^|",Fi.ADDRESS_BOUNDARY,"|[^\\w\\:])("],r,[")(?=[^\\w\\:]|",Fi.ADDRESS_BOUNDARY,"|$)"])),r.join("")},t.prototype.regularExpression=function(t){return void 0===t&&(t=!1),new RegExp(this.regularExpressionString(t),"i")},t}();e.Address6=p}),qi=E(function(t,e){var r=_&&_.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=_&&_.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=_&&_.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.v6=e.Address6=e.Address4=void 0,Object.defineProperty(e,"Address4",{enumerable:!0,get:function(){return Di.Address4}}),Object.defineProperty(e,"Address6",{enumerable:!0,get:function(){return Ui.Address6}});var o=i(ji);e.v6={helpers:o}});const Gi=Object.assign($("libp2p:ip-port-to-multiaddr"),{error:$("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:$i}=l,{Address4:Ki,Address6:Hi}=qi,Vi={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};var Wi=function(t,e){if("string"!=typeof t)throw H(new Error(`invalid ip provided: ${t}`),Vi.ERR_INVALID_IP_PARAMETER);if("string"==typeof e&&(e=parseInt(e)),isNaN(e))throw H(new Error(`invalid port provided: ${e}`),Vi.ERR_INVALID_PORT_PARAMETER);try{return new Ki(t),new $i(`/ip4/${t}/tcp/${e}`)}catch{}try{const r=new Hi(t);return r.is4()?new $i(`/ip4/${r.to4().correctForm()}/tcp/${e}`):new $i(`/ip6/${t}/tcp/${e}`)}catch(r){const n=`invalid ip:port for creating a multiaddr: ${t}:${e}`;throw Gi.error(n),H(new Error(n),Vi.ERR_INVALID_IP)}};Wi.Errors=Vi;const{CLOSE_TIMEOUT:zi}=Ti,Yi=$("libp2p:webrtcdirect:socket");Yi.error=$("libp2p:webrtcdirect:socket:error"),$("libp2p:webrtcdirect:listener").error=$("libp2p:webrtcdirect:listener:error");const Zi=$,Ji=Zi("libp2p:webrtcdirect");Ji.error=Zi("libp2p:webrtcdirect:error");const{AbortError:Xi}=wi,{CODE_CIRCUIT:Qi,CODE_P2P:to}=Ti;var eo=di(class{constructor({upgrader:t}){$(t,"An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader."),this._upgrader=t}async dial(t,e={}){const r=((t,e={})=>{const{sink:r,source:n}=ki.duplex(t),i={async sink(t){e.signal&&(t=wi(t,e.signal));try{await r(async function*(){for await(const e of t)yield e instanceof Uint8Array?e:e.slice()}())}catch(t){"aborted"!==t.type&&Yi.error(t)}},source:e.signal?wi(n,e.signal):n,conn:t,localAddr:t.localAddress&&t.localPort?Wi(t.localAddress,t.localPort):void 0,remoteAddr:e.remoteAddr,timeline:{open:Date.now()},close(){if(!t.destroyed)return new Promise((e,r)=>{const n=Date.now(),o=setTimeout(()=>{if(i.remoteAddr){const{host:t,port:e}=i.remoteAddr.toOptions();Yi("timeout closing socket to %s:%s after %dms, destroying it manually",t,e,Date.now()-n)}t.destroyed||t.destroy()},zi);t.once("close",()=>{e()}),t.end(t=>{if(clearTimeout(o),i.timeline.close=Date.now(),t)return r(t)})})}};return t.once("close",()=>{i.timeline.close||(i.timeline.close=Date.now())}),i})(await this._connect(t,e),{remoteAddr:t,signal:e.signal});Ji("new outbound connection %s",r.remoteAddr);const n=await this._upgrader.upgradeOutbound(r);return Ji("outbound connection %s upgraded",r.remoteAddr),n}_connect(t,e={}){if(e.signal&&e.signal.aborted)throw new Xi;return e={initiator:!0,trickle:!1,wrtc:void 0,...e},new Promise((r,n)=>{const i=Date.now();let o;const s=t.toOptions();Ji("Dialing %s:%s",s.host,s.port);const a=new pn(e),u=t=>{if(!o){const e=`connection error ${s.host}:${s.port}: ${t.message}`;Ji.error(e),t.message=e,d(t)}},c=()=>{Ji("connnection timeout %s:%s",s.host,s.port);const t=H(new Error(`connection timeout after ${Date.now()-i}ms`),"ERR_CONNECT_TIMEOUT");a.emit("error",t)},l=()=>{o=!0,Ji("connection opened %s:%s",s.host,s.port),d(null)},f=()=>{Ji.error("connection aborted %s:%s",s.host,s.port),a.destroy(),d(new Xi)},d=t=>{a.removeListener("error",u),a.removeListener("timeout",c),a.removeListener("connect",l),a.removeAllListeners("signal"),e.signal&&e.signal.removeEventListener("abort",f),t?n(t):r(a)};a.once("error",u),a.once("timeout",c),a.once("connect",l),a.on("close",()=>a.destroy()),e.signal&&e.signal.addEventListener("abort",f),a.on("signal",t=>{const e=JSON.stringify(t),r="https://"+s.host+":"+s.port,i="/?signal="+h(ni.encode("base58btc",(new TextEncoder).encode(e)));ui.get(r+i,(t,e)=>{if(t)return n(t);const r=ni.decode(e.body),i=h(r),o=JSON.parse(i);a.signal(o)})})})}createListener(t={},e){throw H(new Error("Can't listen if run from the Browser"),"ERR_NO_SUPPORT_FROM_BROWSER")}filter(t){return(t=Array.isArray(t)?t:[t]).filter(t=>!t.protoCodes().includes(Qi)&&Fn.WebRTCDirect.matches(t.decapsulateCode(to)))}},{className:"WebRTCDirect",symbolName:"@libp2p/js-libp2p-webrtc-direct/webrtcdirect"});const{Request:ro,Response:no,StoreKeyFragmentResponse:io,GetKeyFragmentResponse:oo}=C,so={zipAndEncryptString:async function(e){const r=new t;return r.file("string.txt",e),N(r)},zipAndEncryptFiles:async function(e){const r=new t;for(let t=0;t<e.length;t++)r.folder("encryptedAssets").file(e[t].name,e[t]);return N(r)},encryptZip:N,decryptZip:x,connectWeb3:I,checkAndSignAuthMessage:O,createHtmlLIT:async function({title:t,htmlBody:e,css:r,encryptedZipDataUrl:n,tokenAddress:i,tokenId:o,chain:s,npmPackages:a=[]}){let u="";for(let t=0;t<a.length;t++)u+=`<script src="${await L(a[t])}"><\/script>\n`;return`\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>${t}</title>\n    <style id="jss-server-side">${r}</style>\n    ${u}\n    <script>\n      var encryptedZipDataUrl = "${n}"\n      var tokenAddress = "${i}"\n      var tokenId = "${o}"\n      var chain = "${s}"\n      var locked = true\n\n      function litJsSdkLoaded(){\n         var litNodeClient = new LitJsSdk.default.LitNodeClient()\n        litNodeClient.connect()\n        window.litNodeClient = litNodeClient\n      }\n    <\/script>\n    <script onload='litJsSdkLoaded()' src="https://unpkg.com/lit-js-sdk/build/index.web.js"><\/script>\n  </head>\n  <body>\n    <div id="root">${e}</div>\n    <script>\n      const unlockButton = document.getElementById('unlockButton')\n      unlockButton.onclick = function() {\n        LitJsSdk.default.toggleLock()\n      }\n    <\/script>\n  </body>\n</html>\n  `},mintLIT:async function({chain:t,quantity:e}){console.log(`minting ${e} tokens on ${t}`);const r=await O(),{web3:n,account:i}=await I();if(await n.eth.getChainId()!==k[t].chainId)return{errorCode:"wrong_chain"};const o=k[t].contractAddress,s=new n.eth.Contract(A,o);console.log("sending to chain...");try{const t=await s.methods.mint(e).send({from:i});return console.log("txReceipt: ",t),{txHash:t.transactionHash,tokenId:t.events.TransferSingle.returnValues.id,tokenAddress:o,mintingAddress:i,authSig:r}}catch(t){return console.log(t),4001===t.code?(console.log("User rejected request"),{errorCode:"user_rejected_request"}):(console.error(t),{errorCode:"unknown_error"})}},toggleLock:async function(){const t=document.getElementById("mediaGridHolder"),e=document.getElementById("lockedHeader");if(window.locked){window.publicContent=t.innerHTML;const r=await O(),n=await window.litNodeClient.getEncryptionKey({tokenAddress:window.tokenAddress,tokenId:window.tokenId,authSig:r,chain:window.chain}),i=await(await fetch(window.encryptedZipDataUrl)).blob(),o=await x(i,n),s=await o["string.txt"].async("text");t.innerHTML=s,e.innerText="UNLOCKED",window.locked=!1}else t.innerHTML=window.publicContent,e.innerText="LOCKED",window.locked=!0},LIT_CHAINS:k,LitNodeClient:class{constructor(t){this.libp2p=null,this.connectedNodes=new Set,this.serverPubKeys={}}async getEncryptionKey({tokenAddress:t,tokenId:e,authSig:r,chain:n}){const i=await this.getEncryptionKeyFragments({tokenAddress:t,tokenId:e,authSig:r,chain:n}),o=JSON.parse(localStorage.getItem("lit-comms-keypair")),s=[];for(let t=0;t<i.length;t++){const e=R(JSON.parse(i[t]),o.secretKey);s.push(e)}const a=b.combine(s);return Buffer.from(a,"hex").toString()}async saveEncryptionKey({tokenAddress:t,tokenId:e,symmetricKey:n,authSig:i,chain:o}){console.log(`saveEncryptionKey with tokenAddress ${t} and tokenId ${e} and symmetricKey ${n} and authSig ${i} and chain ${o}`);const s=Array.from(this.connectedNodes),a=s.length,u=Math.floor(a/2),c=Buffer.from(n).toString("hex");console.debug(`splitting up into ${a} shares with a threshold of ${u}`);const l=b.share(c,a,u);if(l.length!==s.length)throw new Error(`kFrags.length (${l.length}) !== nodes.length (${s.length})`);const h=[],f=t.toLowerCase();for(let t=0;t<s.length;t++){const n=s[t];console.debug(`storing kFrag in node ${t+1} of ${s.length}`);const a=r.encodeBase64(this.serverPubKeys[n]),u=JSON.stringify(T(a,l[t],"x25519-xsalsa20-poly1305"));h.push(this.storeDataWithNode({peerId:n,tokenAddress:f,tokenId:e,val:u,authSig:i,chain:o}))}return await Promise.all(h),console.log("all stored"),{success:!0}}async getEncryptionKeyFragments({tokenAddress:t,tokenId:e,authSig:r,chain:n}){const i=t.toLowerCase(),o=D({tokenAddress:t,tokenId:e,chain:n}),s=new a(o),u=await w(this.libp2p.contentRouting.findProviders(s,{timeout:3e3}));console.log(`Found ${u.length} providers`);const c=[];for(let t=0;t<u.length;t++){const s=u[t].id.toB58String();console.debug(`Getting ${o} from ${s}`),c.push(this.getDataFromNode({peerId:s,tokenAddress:i,tokenId:e,authSig:r,keyId:o,chain:n}))}return await Promise.all(c)}async storeDataWithNode({peerId:t,tokenAddress:e,tokenId:r,val:n,authSig:i,chain:o}){console.debug(`storing data with node ${t} with tokenAddress ${e} and tokenId ${r}`);const s=ro.encode({type:ro.Type.STORE_KEY_FRAGMENT,storeKeyFragment:{fragmentValue:v(n)},authSig:v(JSON.stringify(i)),tokenParams:{tokenAddress:v(e),tokenId:v(r.toString()),chain:v(o)}});return await this.sendCommandToPeer({peerId:t,data:s})}async getDataFromNode({peerId:t,tokenAddress:e,tokenId:n,keyId:i,authSig:o,chain:s}){console.debug(`getDataFromNode ${t} with keyId ${i}`);const a=JSON.parse(localStorage.getItem("lit-comms-keypair")),u=ro.encode({type:ro.Type.GET_KEY_FRAGMENT,getKeyFragment:{keyId:v(i)},authSig:v(JSON.stringify(o)),tokenParams:{tokenAddress:v(e),tokenId:v(n.toString()),chain:v(s)},clientPubKey:r.decodeBase64(a.publicKey)});return await this.sendCommandToPeer({peerId:t,data:u})}async handshakeWithSgx({peerId:t}){console.debug(`handshakeWithSgx ${t}`);const e=ro.encode({type:ro.Type.HANDSHAKE});return await this.sendCommandToPeer({peerId:t,data:e})}async sendCommandToPeer({peerId:t,data:e}){var n=this;const i=this.libp2p.connectionManager.get(y.createFromB58String(t)),{stream:o}=await i.newStream(["/lit/1.0.0"]);console.debug(`sendCommandToPeer ${t}`);let s=null;return await m([e],o,async function(e){console.debug("in sendCommandToPeer callback");const{value:i}=await e.next(),o=no.decode(i.slice());o.type===no.Type.HANDSHAKE_RESPONSE?(n.serverPubKeys[t]=o.serverPubKey,console.log("handshake success for "+t+" - got server pub key "+r.encodeBase64(o.serverPubKey)),s=!0):o.type===no.Type.STORE_KEY_FRAGMENT_RESPONSE?o.storeKeyFragmentResponse.result===io.Result.SUCCESS?(console.log("success storing key fragment"),s=!0):o.storeKeyFragmentResponse.result===io.Result.AUTH_FAILURE?(console.log("auth failure.  user doesnt own token"),alert("You are not authorized to publish to this LIT"),s=!1):(console.log("error storing key fragment: "),console.log(h(o.storeKeyFragmentResponse.errorMessage)),s=!1):o.type===no.Type.GET_KEY_FRAGMENT_RESPONSE?o.getKeyFragmentResponse.result===oo.Result.SUCCESS?(console.log("success getting key fragment"),s=h(o.getKeyFragmentResponse.fragmentValue)):o.getKeyFragmentResponse.result===oo.Result.NOT_FOUND?(console.log("key fragment not found"),s=!1):o.getKeyFragmentResponse.result===oo.Result.AUTH_FAILURE?(console.log("auth failure.  user doesnt own token"),alert("You are not authorized to unlock this LIT"),s=!1):(console.log("unknown error getting key fragment"),s=!1):console.log("unknown response type")}),s}async connect(){var t=this;this.libp2p=await u.create({modules:{transport:[c,eo],connEncryption:[f],streamMuxer:[d],dht:p,peerDiscovery:[g]},config:{dht:{enabled:!0},peerDiscovery:{[g.tag]:{enabled:!0,list:["/dns4/node1.litgateway.com/tcp/9090/https/p2p-webrtc-direct/p2p/12D3KooWK1KtaAV5rWjbAmZcd62VYSmEz1k81jzr87JAcSS7rKdQ"]}}}}),this.libp2p.on("peer:discovery",t=>{console.debug(`Found peer ${t.toB58String()}`)}),this.libp2p.connectionManager.on("peer:connect",async function(e){const r=e.remotePeer.toB58String();console.debug(`Connected to ${r}`),t.connectedNodes.has(r)||(t.connectedNodes.add(r),setTimeout(async function(){await t.handshakeWithSgx({peerId:r})},1e3))}),this.libp2p.connectionManager.on("peer:disconnect",t=>{const e=t.remotePeer.toB58String();console.debug(`Disconnected from ${e}`),this.connectedNodes.delete(e)}),await this.libp2p.start(),console.debug(`libp2p id is ${this.libp2p.peerId.toB58String()}`),this.libp2p.multiaddrs.forEach(t=>console.debug(`${t.toString()}/p2p/${this.libp2p.peerId.toB58String()}`)),window.libp2p=this.libp2p,window.PeerId=y}},protobufs:C,kFragKey:D,encryptWithPubKey:T,decryptWithPrivKey:R};export default so;
//# sourceMappingURL=index.modern.js.map
